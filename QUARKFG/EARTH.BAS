COMMON GAMEFILE, X, Y, MX, MY, NAME$, PLANET$, ITEM$
SCREEN 12: CLS
DRAW "BM50,50BR1C6R2F1D1G1L2H1U1BR1P0,6C6BF3L4G1R2D1L3R8G1R1C1BR1D1L1BL8L1U1C6BR1R1BR2R2D1L2C1BH1G1R1D1C8BR1R2C1BR1U1R1H1BU2C6R1C1BU1D0BL6D0BD10BL1R3U1L2BR4R2F1L3BU2C6U2R1D2BL3U2L1D2BR3BU7C8D0BLC15D0"
DIM ASTRONAUT(1 TO 200): GET (42, 50)-(57, 64), ASTRONAUT
LINE (157, 100)-(179, 112), 2, BF
DRAW "BM159,100C8R2GR9D1R2LGDR5FRFRLGLGL5DFRL2DL9GR2U2RU2R5DGBU6RUHBD2L4U2LGLGHGDFGDFEUBU2U0FREUBD3DGLRBUC12HBU2BR1HBR1C14D0GBD3EBL3D0BU3D0D1C12D0BD3D0BU2BR5P7,8BR8C5ER3FRLGL3BU1P13,5BU3BL6P7,8BD7P7,8L3BU8D0"
DIM QUARKR(1 TO 500): GET (157, 100)-(179, 112), QUARKR

CLS
LINE (14, 14)-(614, 414), 2, BF
FOR MARKZ = 1 TO 100
RANDOMIZE TIMER
H = INT(RND * 600) + 14
V = INT(RND * 400) + 14
PSET (H, V), 10
NEXT MARKZ
FOR MARKZ = 1 TO 50
RANDOMIZE TIMER
H = INT(RND * 580) + 14
V = INT(RND * 390) + 24
PSET (H, V), 6: DRAW "E6F2G2E6F8"
NEXT MARKZ
DRAW "BM14,94C1R40D80R40D120R80D120L160U320BFP9,1"
DRAW "BM614,14C1L120D40R40D80R40D40R40U160BGP9,1"

FOR LINEZ = 14 TO 614 STEP 40
LINE (LINEZ, 14)-(LINEZ, 414), 6
NEXT LINEZ
FOR LINEZ = 14 TO 414 STEP 40
LINE (14, LINEZ)-(614, LINEZ), 6
NEXT LINEZ
DRAW "BM424,108BM+6,+12C0L5U7LU4ERFRERFD4LND6L4BDP7,0BU2P7,0BLC15U3BR5C8D3BM-1,+2D5BL3C15U5 BM+20,+6C0L5U7LU4ERFRERFD4LND6L4BDP7,0BU2P7,0BLC15U3BR5C8D3BM-1,+2D5BL3C15U5 BL2C0L9D6R9U6BGP7,0C8D4BL7C15U4BD4BR2C0U2ERFD2BLP6,0BM+7,-2C0UBL16DBU8C8U5C14BRRGBD4BR15C8U5BRC14RG"
DRAW "BM505,346C2R19D19L19U19BFP2,2 BM+1,+4C8D11R8U6RUR2DRD3LFD2L3R6U10L14R2U2NL2URFR9FLC4L10C6UBM-2,+1C4L BM+2,+5C8D2R2U2HDC14DBR3P7,8BR3P6,8"


IF MID$(PLANET$, 3, 1) > "0" THEN PUT (64, 28), QUARKR, PSET
PUT ((MX * 40) + 24, (MY * 40) + 28), ASTRONAUT, XOR
LOCATE 28, 3: COLOR 9: PRINT "RADAR SCAN:"
IF MX = 10 AND MY = 2 THEN LOCATE 28, 15: COLOR 7: PRINT "NOTHING HERE":  ELSE GOSUB RADAR

ON KEY(1) GOSUB BLASTOFF
ON KEY(11) GOSUB UP
ON KEY(12) GOSUB LEFT
ON KEY(13) GOSUB RIGHT
ON KEY(14) GOSUB DOWN
KEY(0) ON

DO
LOOP UNTIL INKEY$ = ""
CHAIN "LOSE.BAS"

UP:
IF MY = 0 THEN RETURN
KEY(0) OFF
PUT ((MX * 40) + 24, (MY * 40) + 28), ASTRONAUT, XOR
MY = MY - 1
PLAY "T200L40O2MBCED"
PUT ((MX * 40) + 24, (MY * 40) + 28), ASTRONAUT, XOR
GOSUB RADAR
KEY(0) ON: RETURN

LEFT:
IF MX = 0 THEN RETURN
KEY(0) OFF
PUT ((MX * 40) + 24, (MY * 40) + 28), ASTRONAUT, XOR
MX = MX - 1
PLAY "T200L40O2MBCED"
PUT ((MX * 40) + 24, (MY * 40) + 28), ASTRONAUT, XOR
GOSUB RADAR
KEY(0) ON: RETURN

RIGHT:
IF MX = 14 THEN RETURN
KEY(0) OFF
PUT ((MX * 40) + 24, (MY * 40) + 28), ASTRONAUT, XOR
MX = MX + 1
PLAY "T200L40O2MBCED"
PUT ((MX * 40) + 24, (MY * 40) + 28), ASTRONAUT, XOR
GOSUB RADAR
KEY(0) ON: RETURN

DOWN:
IF MY = 9 THEN RETURN
KEY(0) OFF
PUT ((MX * 40) + 24, (MY * 40) + 28), ASTRONAUT, XOR
MY = MY + 1
PLAY "T200L40O2MBCED"
PUT ((MX * 40) + 24, (MY * 40) + 28), ASTRONAUT, XOR
GOSUB RADAR
KEY(0) ON: RETURN

RADAR:
LOCATE 28, 15: COLOR 7
IF MID$(PLANET$, 3, 1) > "1" THEN IF MX = 1 AND MY = 0 THEN PRINT "SPACESHIP IDENTIFIED AS QUARK 2000; PRESS [F1] TO BLAST OFF.": GOTO SOMETHING
IF MX = 12 AND MY = 8 THEN PRINT "YOUR HOUSE CONTAINS MODERN FURNITURE AND APPLIANCES.": GOTO SOMETHING
IF MX = 10 AND MY = 2 THEN PRINT "YOU HAVE ENTERED EARTH'S HEADQUARTERS.": GOSUB DELAY: CHAIN "BUILDING.BAS"

IF MID$(PLANET$, 3, 1) > "2" THEN RANDOMIZE TIMER: IF INT(RND * 10) = 1 THEN GOTO WHOA
PRINT "NOTHING HERE                                                      "
SOMETHING: RETURN

DELAY:
FOR DELAY = 1 TO 2000
BABBLE$ = INKEY$
NEXT DELAY
RETURN

WHOA:
KEY(0) OFF
LIGHT = 0
FOR ALARM = 1 TO 50
LIGHT = LIGHT + 1
IF LIGHT = 1 THEN COLOR 14
IF LIGHT = 2 THEN COLOR 12
BABBLE$ = INKEY$
LOCATE 28, 15: PRINT "ENEMY NEAR!                                               "
IF LIGHT = 2 THEN LIGHT = 0
SOUND 200, 1: SOUND 900, 1
NEXT ALARM
CHAIN "EARFIT.BAS"

BLASTOFF:
IF MID$(PLANET$, 3, 1) > "1" THEN IF MX = 1 AND MY = 0 THEN GOSUB BYE ELSE RETURN

BYE:
CHAIN "BLASTOFF.BAS"

