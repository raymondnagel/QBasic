COMMON X, Y, H, V, POWER!, N1!, N2!, N3!, MERCPROGRESS!, VENUPROGRESS!, EARTPROGRESS!, MARSPROGRESS!, JUPIPROGRESS!, SATUPROGRESS!, URANPROGRESS!, NEPTPROGRESS, PLUTPROGRESS!, BOMB1!
DIM SHIPU%(1 TO 50)
DIM SHIPD%(1 TO 500)
DIM SHIPL%(1 TO 500)
DIM SHIPR%(1 TO 500)
SCREEN 13: CLS
PRESET (10, 10): DRAW "C7BR2D3E1R1D1C12D0BU1C7L4D1C12D0BE1C7U3E1U1D1F1D2BU1BH1C8D1"
GET (10, 7)-(14, 13), SHIPU%: CLS
PUT (100, 100), SHIPU%, XOR
PRESET (10, 10): DRAW "A2C7BR2D3E1R1D1C12D0BU1C7L4D1C12D0BE1C7U3E1U1D1F1D2BU1BH1C8D1"
GET (6, 7)-(10, 13), SHIPD%: CLS
PRESET (10, 10): DRAW "C12D0BD2C7D0BD2C12D0C7BR1U4F1D2R2E1R1L1H1L1C8BD1R1"
GET (10, 10)-(16, 14), SHIPR%: CLS
PRESET (10, 10): DRAW "A2C12D0BD2C7D0BD2C12D0C7BR1U4F1D2R2E1R1L1H1L1C8BD1R1"
GET (4, 6)-(10, 10), SHIPL%: CLS
DIM HOLE%(1 TO 100)
DRAW "BM50,50C8R5D4L3U2R1"
GET (50, 50)-(55, 54), HOLE%
CLS
IF X = 210 AND Y = 110 THEN GOSUB LAUNCH
IF X = 220 AND Y = 86 THEN GOSUB LAUNCH
IF X = 212 AND Y = 56 THEN GOSUB LAUNCH
IF X = 178 AND Y = 36 THEN GOSUB LAUNCH
IF X = 118 AND Y = 12 THEN GOSUB LAUNCH
IF X = 68 AND Y = 32 THEN GOSUB LAUNCH
IF X = 40 AND Y = 64 THEN GOSUB LAUNCH
IF X = 20 AND Y = 98 THEN GOSUB LAUNCH
IF X = 30 AND Y = 138 THEN GOSUB LAUNCH
FOR STARZ% = 1 TO 200: LET C = INT(RND * 320): LET D = INT(RND * 200): PSET (C, D), 15: NEXT STARZ%
CIRCLE (160, 100), 40, 12: PAINT STEP(0, 0), 14, 12  'THE SUN
CIRCLE STEP(50, 10), 2, 5: PAINT STEP(0, 0), 13, 5  'MERCURY
CIRCLE STEP(10, -24), 8, 1: PAINT STEP(0, 0), 9, 1  'VENUS
CIRCLE STEP(-8, -30), 8, 2: PAINT STEP(0, 0), 1, 2  'EARTH
CIRCLE STEP(-34, -20), 7, 5: PAINT STEP(0, 0), 4, 5  'MARS
CIRCLE STEP(-60, -24), 10, 4: PAINT STEP(0, 0), 6, 4  'JUPITER
CIRCLE STEP(-50, 20), 9, 30: PAINT STEP(0, 0), 6, 30: DRAW "C15F8R1U1H2BH12H2L1D1F10" 'SATURN
CIRCLE STEP(-30, 30), 8, 1: PAINT STEP(0, 0), 5, 1 'URANUS
CIRCLE STEP(-20, 34), 8, 9: PAINT STEP(0, 0), 1, 9 'NEPTUNE
CIRCLE STEP(10, 40), 2, 5: PAINT STEP(0, 0), 9, 5 'PLUTO
CIRCLE (160, 100), 96, 7 'ASTEROID BELT
ON KEY(11) GOSUB 100
ON KEY(12) GOSUB 200
ON KEY(13) GOSUB 300
ON KEY(14) GOSUB 400
KEY(0) ON
PUT (X - 2, Y - 3), SHIPD%, XOR
PUT (H - 2, V - 2), HOLE%, XOR
LET POSITION$ = "DOWN"

50 DO
LOCATE 1, 36: COLOR 7: PRINT POWER!
IF POWER! <= 0 THEN CHAIN "SPACEWAR.BTL"
RANDOMIZE TIMER: LET M = INT(RND * 4) + 1
IF M = 1 THEN GOSUB 10000
IF M = 2 THEN GOSUB 10010
IF M = 3 THEN GOSUB 10020
IF M = 4 THEN GOSUB 10030
IF X > H - 10 AND X < H + 10 AND Y > V - 10 AND Y < V + 10 THEN CHAIN "BLAKHOLE.ESC"
LOOP UNTIL INKEY$ = ""
SYSTEM

100 IF Y - 8 <= 0 THEN RETURN
KEY(0) STOP
IF POSITION$ = "UP" THEN PUT (X - 2, Y - 3), SHIPU%, XOR
IF POSITION$ = "RIGHT" THEN PUT (X - 2, Y - 2), SHIPR%, XOR
IF POSITION$ = "LEFT" THEN PUT (X - 2, Y - 2), SHIPL%, XOR
IF POSITION$ = "DOWN" THEN PUT (X - 2, Y - 3), SHIPD%, XOR
LET Y = Y - 2: IF POINT(X + 1, Y) = 7 THEN CHAIN "ASTEROID.ESC"
PUT (X - 2, Y - 3), SHIPU%, XOR
LET POWER! = POWER! - 1
RANDOMIZE TIMER: IF INT(RND * 50) = 13 THEN KEY(0) ON: CHAIN "SPACEWAR.BTL"
IF X = 210 AND Y = 110 THEN CHAIN "MERCURY.PLN"
IF X = 220 AND Y = 86 THEN CHAIN "VENUS.PLN"
IF X = 212 AND Y = 56 THEN CHAIN "EARTH.PLN"
IF X = 178 AND Y = 36 AND PLUTPROGRESS! = 1 THEN CHAIN "MARS.PLN"
IF X = 178 AND Y = 36 AND PLUTPROGRESS! = 0 THEN CHAIN "SHOOT'EM.POW"
IF X = 118 AND Y = 12 THEN CHAIN "JUPITER.PLN"
IF X = 68 AND Y = 32 THEN CHAIN "SATURN.PLN"
IF X = 40 AND Y = 64 THEN CHAIN "URANUS.PLN"
IF X = 20 AND Y = 98 THEN CHAIN "NEPTUNE.PLN"
IF X = 30 AND Y = 138 THEN CHAIN "PLUTO.PLN"
LET POSITION$ = "UP"
KEY(0) ON: RETURN

200 IF X - 8 <= 0 THEN RETURN
KEY(0) STOP
IF POSITION$ = "UP" THEN PUT (X - 2, Y - 3), SHIPU%, XOR
IF POSITION$ = "RIGHT" THEN PUT (X - 2, Y - 2), SHIPR%, XOR
IF POSITION$ = "LEFT" THEN PUT (X - 2, Y - 2), SHIPL%, XOR
IF POSITION$ = "DOWN" THEN PUT (X - 2, Y - 3), SHIPD%, XOR
LET X = X - 2: IF POINT(X + 1, Y) = 7 THEN CHAIN "ASTEROID.ESC"
PUT (X - 2, Y - 2), SHIPL%, XOR
LET POWER! = POWER! - 1
RANDOMIZE TIMER: IF INT(RND * 50) = 13 THEN KEY(0) ON: CHAIN "SPACEWAR.BTL"
IF X = 210 AND Y = 110 THEN CHAIN "MERCURY.PLN"
IF X = 220 AND Y = 86 THEN CHAIN "VENUS.PLN"
IF X = 212 AND Y = 56 THEN CHAIN "EARTH.PLN"
IF X = 178 AND Y = 36 AND PLUTPROGRESS! = 1 THEN CHAIN "MARS.PLN"
IF X = 178 AND Y = 36 AND PLUTPROGRESS! = 0 THEN CHAIN "SHOOT'EM.POW"
IF X = 118 AND Y = 12 THEN CHAIN "JUPITER.PLN"
IF X = 68 AND Y = 32 THEN CHAIN "SATURN.PLN"
IF X = 40 AND Y = 64 THEN CHAIN "URANUS.PLN"
IF X = 20 AND Y = 98 THEN CHAIN "NEPTUNE.PLN"
IF X = 30 AND Y = 138 THEN CHAIN "PLUTO.PLN"
LET POSITION$ = "LEFT"
KEY(0) ON: RETURN

300 IF X + 8 >= 320 THEN RETURN
KEY(0) STOP
IF POSITION$ = "UP" THEN PUT (X - 2, Y - 3), SHIPU%, XOR
IF POSITION$ = "RIGHT" THEN PUT (X - 2, Y - 2), SHIPR%, XOR
IF POSITION$ = "LEFT" THEN PUT (X - 2, Y - 2), SHIPL%, XOR
IF POSITION$ = "DOWN" THEN PUT (X - 2, Y - 3), SHIPD%, XOR
LET X = X + 2: IF POINT(X + 1, Y) = 7 THEN CHAIN "ASTEROID.ESC"
PUT (X - 2, Y - 2), SHIPR%, XOR
LET POWER! = POWER! - 1
RANDOMIZE TIMER: IF INT(RND * 50) = 13 THEN KEY(0) ON: CHAIN "SPACEWAR.BTL"
IF X = 210 AND Y = 110 THEN CHAIN "MERCURY.PLN"
IF X = 220 AND Y = 86 THEN CHAIN "VENUS.PLN"
IF X = 212 AND Y = 56 THEN CHAIN "EARTH.PLN"
IF X = 178 AND Y = 36 AND PLUTPROGRESS! = 1 THEN CHAIN "MARS.PLN"
IF X = 178 AND Y = 36 AND PLUTPROGRESS! = 0 THEN CHAIN "SHOOT'EM.POW"
IF X = 118 AND Y = 12 THEN CHAIN "JUPITER.PLN"
IF X = 68 AND Y = 32 THEN CHAIN "SATURN.PLN"
IF X = 40 AND Y = 64 THEN CHAIN "URANUS.PLN"
IF X = 20 AND Y = 98 THEN CHAIN "NEPTUNE.PLN"
IF X = 30 AND Y = 138 THEN CHAIN "PLUTO.PLN"
LET POSITION$ = "RIGHT"
KEY(0) ON: RETURN

400 IF Y + 8 >= 200 THEN RETURN
KEY(0) STOP
IF POSITION$ = "UP" THEN PUT (X - 2, Y - 3), SHIPU%, XOR
IF POSITION$ = "RIGHT" THEN PUT (X - 2, Y - 2), SHIPR%, XOR
IF POSITION$ = "LEFT" THEN PUT (X - 2, Y - 2), SHIPL%, XOR
IF POSITION$ = "DOWN" THEN PUT (X - 2, Y - 3), SHIPD%, XOR
LET Y = Y + 2: IF POINT(X + 1, Y) = 7 THEN CHAIN "ASTEROID.ESC"
PUT (X - 2, Y - 3), SHIPD%, XOR
LET POWER! = POWER! - 1
RANDOMIZE TIMER: IF INT(RND * 50) = 13 THEN KEY(0) ON: CHAIN "SPACEWAR.BTL"
IF X = 210 AND Y = 110 THEN CHAIN "MERCURY.PLN"
IF X = 220 AND Y = 86 THEN CHAIN "VENUS.PLN"
IF X = 212 AND Y = 56 THEN CHAIN "EARTH.PLN"
IF X = 178 AND Y = 36 AND PLUTPROGRESS! = 1 THEN CHAIN "MARS.PLN"
IF X = 178 AND Y = 36 AND PLUTPROGRESS! = 0 THEN CHAIN "SHOOT'EM.POW"
IF X = 118 AND Y = 12 THEN CHAIN "JUPITER.PLN"
IF X = 68 AND Y = 32 THEN CHAIN "SATURN.PLN"
IF X = 40 AND Y = 64 THEN CHAIN "URANUS.PLN"
IF X = 20 AND Y = 98 THEN CHAIN "NEPTUNE.PLN"
IF X = 30 AND Y = 138 THEN CHAIN "PLUTO.PLN"
LET POSITION$ = "DOWN"
KEY(0) ON: RETURN

LAUNCH:
CLS : LOCATE 11, 15: COLOR 14: PRINT "BLAST OFF"
FOR F = 100 TO 1000 STEP 10
SOUND F, .5
NEXT F
CLS
RETURN

10000 IF POINT(H, V - 5) < 0 THEN RETURN
KEY(0) STOP
PUT (H - 2, V - 2), HOLE%, XOR
LET V = V - 2: PUT (H - 2, V - 2), HOLE%, XOR
KEY(0) ON: RETURN
10010 IF POINT(H - 5, V) < 0 THEN RETURN
KEY(0) STOP
PUT (H - 2, V - 2), HOLE%, XOR
LET H = H - 2: PUT (H - 2, V - 2), HOLE%, XOR
KEY(0) ON: RETURN
10020 IF POINT(H + 5, V) < 0 THEN RETURN
KEY(0) STOP
PUT (H - 2, V - 2), HOLE%, XOR
LET H = H + 2: PUT (H - 2, V - 2), HOLE%, XOR
KEY(0) ON: RETURN
10030 IF POINT(H, V + 5) < 0 THEN RETURN
KEY(0) STOP
PUT (H - 2, V - 2), HOLE%, XOR
LET V = V + 2: PUT (H - 2, V - 2), HOLE%, XOR
KEY(0) ON: RETURN

