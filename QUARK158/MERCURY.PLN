COMMON X, Y, H, V, POWER!, N1!, N2!, N3!, MERCPROGRESS!, VENUPROGRESS!, EARTPROGRESS!, MARSPROGRESS!, JUPIPROGRESS!, SATUPROGRESS!, URANPROGRESS!, NEPTPROGRESS, PLUTPROGRESS!, BOMB1!
LET F = 180: LET G = 110
SCREEN 13
0 CLS
LOCATE 10, 1: COLOR 13: PRINT "INPUT '": COLOR 5: LOCATE 10, 8: PRINT "1": COLOR 13: LOCATE 10, 9: PRINT "' TO LAND ON MERCURY."
LOCATE 12, 1: COLOR 13: PRINT "INPUT '": COLOR 5: LOCATE 12, 8: PRINT "2": COLOR 13: LOCATE 12, 9: PRINT "' TO REFILL POWER AT PORT."
LOCATE 14, 1: COLOR 13: PRINT "INPUT '": COLOR 5: LOCATE 14, 8: PRINT "3": COLOR 13: LOCATE 14, 9: PRINT "' TO LAUNCH INTO SPACE."
1 LOCATE 16, 1: COLOR 5: INPUT "", CHOICE!
IF CHOICE! = 1 THEN GOTO LAND
IF CHOICE! = 2 THEN GOTO REFILL
IF CHOICE! = 3 THEN CHAIN "SOLAR.SYS"
GOTO 1

REFILL:
CLS : LOCATE 10, 1: COLOR 10: PRINT "POWER UNITS:"
COLOR 7
FOR P = 100 TO 1200 STEP 2
LOCATE 10, 13: PRINT POWER!
IF POWER! = 500 THEN EXIT FOR
LET POWER! = POWER! + 1
SOUND P, .2
NEXT P
LOCATE 12, 1: COLOR 10: PRINT "POWER HAS BEEN REFILLED"
PLAY "T200L50O2CDEDO1CDEDC"
SLEEP 3
GOTO 0

LAND:
SCREEN 13: CLS : DIM ICON%(1 TO 30): DRAW "BM50,50 C255 R2D1L2R1D2L2R4L2D2G2E2F2H2": GET (49, 50)-(54, 57), ICON%
LET BUMP$ = "C5U2M+2,-4R8M+2,+4D2"
PAINT (160, 100), 13, 7
FOR B = 1 TO 100
RANDOMIZE 1
LET U = INT(RND * 300) + 11
LET K = INT(RND * 180) + 6
PRESET (U, K), 5: DRAW BUMP$
NEXT B
DRAW "BM10,30C1U20R5D10R2E1R5F1R2D10L15R8C1U6R4D6L3BU1P1,1BL5P9,1"
PUT (F - 2, G - 4), ICON%, XOR
ON KEY(11) GOSUB 100
ON KEY(12) GOSUB 200
ON KEY(13) GOSUB 300
ON KEY(14) GOSUB 400
PRESET (200, 100): DRAW "C7D1F1D2BL2U2BF3G2H2D8BR4U7BF3R1D5L2U4D2G2R8D1G3L3U3F1E1BD6F1D2H1L3H1G1L1R1E2BR2H1L1U2G2L1BU6R1F1D2"
PRESET (200, 100): DRAW "C7D1G1D2BR2U2BG3F2E2D8BL4U7BG3L1D5R2U4D2F2L8D1F3R3U3G1H1BD6G1D2E1R3E1F1R1L1H2BL2E1R1U2F2R1BU6L1G1D2"
PAINT (200, 102), 8, 7: PAINT (200, 108), 8, 7: PAINT (200, 115), 8, 7: PAINT (200, 121), 8, 7: PAINT (204, 121), 8, 7: PAINT (196, 121), 8, 7: PAINT (195, 117), 8, 7: PAINT (197, 117), 8, 7: PAINT (203, 117), 8, 7: PAINT (205, 117), 8, 7: PAINT (205, 115), 12, 7: PAINT (195, 115), 12, 7: PAINT (195, 113), 8, 7: PAINT (205, 113), 8, 7
KEY(0) ON


10 DO
IF F = 200 THEN IF G = 110 OR G = 115 THEN CHAIN "SOLAR.SYS"
IF F = 20 AND G = 30 THEN GOTO 1000
LOOP UNTIL INKEY$ = ""
SYSTEM

100 KEY(0) STOP
IF G - 5 <= 0 THEN KEY(0) ON: RETURN
IF POINT(F, G - 5) = 5 THEN KEY(0) ON: RETURN
IF POINT(F, G - 6) = 5 THEN KEY(0) ON: RETURN
IF POINT(F, G - 7) = 5 THEN KEY(0) ON: RETURN
IF POINT(F, G - 8) = 5 THEN KEY(0) ON: RETURN
IF POINT(F, G - 9) = 5 THEN KEY(0) ON: RETURN
IF POINT(F, G - 10) = 5 THEN KEY(0) ON: RETURN
PUT (F - 2, G - 4), ICON%, XOR
LET G = G - 5: PUT (F - 2, G - 4), ICON%, XOR
KEY(0) ON: RETURN

200 KEY(0) STOP
IF F - 5 <= 0 THEN KEY(0) ON: RETURN
PUT (F - 2, G - 4), ICON%, XOR
LET F = F - 5: PUT (F - 2, G - 4), ICON%, XOR
KEY(0) ON: RETURN

300 KEY(0) STOP
IF F + 5 >= 320 THEN KEY(0) ON: RETURN
PUT (F - 2, G - 4), ICON%, XOR
LET F = F + 5: PUT (F - 2, G - 4), ICON%, XOR
KEY(0) ON: RETURN

400 KEY(0) STOP
IF G + 5 >= 200 THEN KEY(0) ON: RETURN
PUT (F - 2, G - 4), ICON%, XOR
LET G = G + 5: PUT (F - 2, G - 4), ICON%, XOR
KEY(0) ON: RETURN

1000 SCREEN 8: CLS : COLOR 5: PRINT "(IMPERIAL PALACE OF EMPEROR PAUL KEPLER, MERCURY)"
IF MERCPROGRESS! = 0 THEN GOTO 1010
IF MERCPROGRESS! = 1 THEN GOTO 1020
IF MERCPROGRESS! > 1 THEN GOTO 1030
1010
COLOR 13: PRINT : PRINT "KEPLER: I have heard that you wish to destroy the QUARK factory on Mars."
PRINT "Is this true?"
COLOR 15: PRINT : INPUT "MAELSTROM: ", TALK$
IF TALK$ = "YES" OR TALK$ = "yes" THEN LET MERCPROGRESS! = MERCPROGRESS! + 1: GOTO 1000
IF TALK$ = "NO" OR TALK$ = "no" THEN COLOR 13: PRINT : PRINT "KEPLER: Then you have no business here. Be gone": SLEEP 20: LET G = G + 5: GOTO LAND
COLOR 13: PRINT : PRINT "KEPLER: If you do not wish to take this matter seriously, then off with you": SLEEP 20: LET G = G + 5: GOTO LAND
1020
COLOR 13: PRINT : PRINT "KEPLER: In that case, I can help you. Duke Troy de Esceville of Neptune has"
PRINT "a large bomb that should suit your liking. Consult Emperor Caesar Bainbridge"
PRINT "for de Esceville's royal password. You may be dismissed.": LET MERCPROGRESS! = 2: SLEEP 50: LET G = G + 5: GOTO LAND
1030
COLOR 13: PRINT : PRINT "KEPLER: When you get the bomb from Duke de Esceville, head for Mars.": SLEEP 30: LET G = G + 5: GOTO LAND

