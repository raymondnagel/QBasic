COMMON GAMEFILE, X, Y, MX, MY, NAME$, PLANET$, ITEM$
SCREEN 13
HORZ = 1: VERT = 1
ENEXC = 2: QRK = 1: ADV = 1: PHASER = 1000: PHASER2 = 1000
IF MID$(PLANET$, 15, 2) = "20" THEN ENEXC = 5
D = 280: C = 180
DRAW "C8R2GR9D1R2LGDR5FRFRLGLGL5DFRL2DL9GR2U2RU2R5DGBU6RUHBD2L4U2LGLGHGDFGDFEUBU2U0FREUBD3DGLRBUC12HBU2BR1HBR1C14D0GBD3EBL3D0BU3D0D1C12D0BD3D0BU2BR5P7,8BR8C5ER3FRLGL3BU1P13,5BU3BL6P7,8BD7P7,8L3BU8D0"
DIM QUARKR(1 TO 500)
GET (157, 100)-(179, 112), QUARKR
CLS
DRAW "A2C8R2GR9D1R2LGDR5FRFRLGLGL5DFRL2DL9GR2U2RU2R5DGBU6RUHBD2L4U2LGLGHGDFGDFEUBU2U0FREUBD3DGLRBUC12HBU2BR1HBR1C14D0GBD3EBL3D0BU3D0D1C12D0BD3D0BU2BR5P7,8BR8C5ER3FRLGL3BU1P13,5BU3BL6P7,8BD7P7,8L3BU8D0"
DIM QUARKL(1 TO 500)
GET (141, 88)-(163, 100), QUARKL
CLS
DIM ADVERSARY(1 TO 200)
DRAW "BM290,86C15GLGLDLDLFC4RBR3RBR3RBR3RBL2C14LBL3LBL3LDC8R9BM+3,-2LUHLHLHLC7LGR3BM+2,+1DR2DL11ERUBR3C15G"
GET (284, 86)-(299, 92), ADVERSARY
CLS
A = 10: LET B = 20
FOR STARZ = 1 TO 30: RANDOMIZE TIMER: H = INT(RND * 320) + 1: V = INT(RND * 200) + 1: PSET (H, V), 15: NEXT STARZ
FOR STARZ = 1 TO 40: RANDOMIZE TIMER: H = INT(RND * 320) + 1: V = INT(RND * 200) + 1: PSET (H, V), 7: NEXT STARZ
FOR STARZ = 1 TO 30: RANDOMIZE TIMER: H = INT(RND * 320) + 1: V = INT(RND * 200) + 1: PSET (H, V), 8: NEXT STARZ
QUARK$ = "RIGHT": PUT (A - 7, B - 6), QUARKR
PUT (D, C), ADVERSARY, XOR
ON KEY(1) GOSUB PHASER
ON KEY(2) GOSUB BRAKE
ON KEY(3) GOSUB WARP
ON KEY(11) GOSUB 100
ON KEY(12) GOSUB 200
ON KEY(13) GOSUB 300
ON KEY(14) GOSUB 400

DO
KEY(0) ON: FOR DELAY = 1 TO 40: NEXT DELAY: KEY(0) STOP
IF QUARK$ = "RIGHT" THEN PUT (A - 7, B - 6), QUARKR
IF QUARK$ = "LEFT" THEN PUT (A - 7, B - 6), QUARKL
A = A + HORZ: IF A >= 300 THEN A = 300: HORZ = 0
B = B + VERT: IF B >= 180 THEN B = 180: VERT = 0
IF A <= 10 THEN A = 10: HORZ = 0
IF B <= 20 THEN B = 20: VERT = 0
IF QUARK$ = "RIGHT" THEN PUT (A - 7, B - 6), QUARKR
IF QUARK$ = "LEFT" THEN PUT (A - 7, B - 6), QUARKL
ADVERSARY:
PUT (D, C), ADVERSARY, XOR
D = D + ENEXC: IF INT(RND * 30) = 29 THEN ENEXC = -(ENEXC)
IF D >= A - 30 AND D <= A THEN D = D - 2
IF D <= A + 30 AND D >= A THEN D = D + 2
IF D <= 15 THEN D = 15
IF D >= 300 THEN D = 300
IF C + 3 < B THEN C = C + 2: IF C >= 185 THEN C = 185
IF C + 3 > B THEN C = C - 2: IF C <= 15 THEN C = 15
PUT (D, C), ADVERSARY, XOR
IF PHASER2 = 1000 THEN IF C < B + 40 AND C > B - 40 THEN IF INT(RND * 40) = 2 THEN PHASER2 = D + 7: FOCUS2 = C + 8: DIRECT2 = -10: ON PLAY(25) GOSUB SHOT2: PLAY ON: PLAY "T255L64MBMLO2CDEFGABO4CDEFGABO6CDEFGAB": IF PHASER2 <> 1000 THEN IF D < A THEN DIRECT2 = 10
SHOT2: PLAY OFF
IF PHASER = 1000 THEN GOTO RES
PSET (PHASER, FOCUS), 0: PHASER = PHASER + DIRECT
IF MID$(ITEM$, 1, 1) = "1" THEN IF FOCUS < C THEN FOCUS = FOCUS + 2
IF MID$(ITEM$, 1, 1) = "1" THEN IF FOCUS > C THEN FOCUS = FOCUS - 2
PSET (PHASER, FOCUS), 10
IF PHASER <= D + 18 AND PHASER >= D - 3 AND FOCUS <= C + 8 AND FOCUS >= C - 2 THEN GOSUB BOOM
IF QUARK$ = "RIGHT" THEN IF POINT(PHASER + 1, FOCUS) <> 0 THEN GOSUB BOOM
IF QUARK$ = "LEFT" THEN IF POINT(PHASER - 1, FOCUS) <> 0 THEN GOSUB BOOM

RES:
IF PHASER2 = 1000 THEN GOTO RES2
PSET (PHASER2, FOCUS2), 0: PHASER2 = PHASER2 + DIRECT2
IF MID$(PLANET$, 15, 2) = "20" THEN IF FOCUS2 < B THEN FOCUS2 = FOCUS2 + 2
IF MID$(PLANET$, 15, 2) = "20" THEN IF FOCUS2 > B THEN FOCUS2 = FOCUS2 - 2

PSET (PHASER2, FOCUS2), 13
IF PHASER2 <= A + 15 AND PHASER2 >= A - 1 AND FOCUS2 <= B + 10 AND FOCUS2 >= B - 1 THEN GOSUB BOOM2
IF POINT(PHASER2 + 1, FOCUS2) <> 0 OR POINT(PHASER2 - 1, FOCUS2) <> 0 THEN GOSUB BOOM2
RES2:
LOOP UNTIL INKEY$ = ""
CLS : SYSTEM

PHASER:
IF PHASER <> 1000 THEN RETURN
KEY(0) OFF
IF QUARK$ = "RIGHT" THEN DIRECT = 10: PHASER = A + 15
IF QUARK$ = "LEFT" THEN DIRECT = -10: PHASER = A - 15
ON PLAY(25) GOSUB SHOT1: PLAY ON
PLAY "T255L64MBMLO2CDEFGABO4CDEFGABO6CDEFGAB"
SHOT1: PLAY OFF
FOCUS = B
KEY(0) ON: RETURN

BOOM:
KEY(0) OFF
IF PHASER <= A + 10 AND PHASER >= A - 10 AND FOCUS <= B + 10 AND FOCUS >= B - 10 THEN QRK = 0
IF PHASER <= D + 18 AND PHASER >= D - 3 AND FOCUS <= C + 8 AND FOCUS >= C - 2 THEN ADV = 0
CIRCLE (PHASER, FOCUS), 10, 14: PAINT (PHASER, FOCUS), 12, 14
ON PLAY(25) GOSUB EXPLODE1: PLAY ON
PLAY "T255L64MBO2DBF<DBF<DBF>DBF<DBF"
EXPLODE1: PLAY OFF
CIRCLE (PHASER, FOCUS), 10, 10: PAINT (PHASER, FOCUS), 14, 10
CIRCLE (PHASER, FOCUS), 10, 0: PAINT (PHASER, FOCUS), 0, 0
LINE (PHASER - 5, FOCUS - 5)-(PHASER + 5, FOCUS + 5), 0, BF
IF QRK = 0 THEN FOR DELAY = 1 TO 1000: NEXT DELAY: GOTO LOSE
IF ADV = 0 THEN FOR DELAY = 1 TO 1000: NEXT DELAY: GOTO WIN
PHASER = 1000: KEY(0) ON: RETURN

BOOM2:
KEY(0) OFF
IF PHASER2 <= A + 15 AND PHASER2 >= A - 1 AND FOCUS2 <= B + 10 AND FOCUS2 >= B - 1 THEN QRK = 0
IF PHASER2 <= D + 18 AND PHASER2 >= D - 3 AND FOCUS2 <= C + 8 AND FOCUS2 >= C - 2 THEN ADV = 0
KEY(0) OFF
CIRCLE (PHASER2, FOCUS2), 10, 14: PAINT (PHASER2, FOCUS2), 12, 14
ON PLAY(25) GOSUB EXPLODE2: PLAY ON
PLAY "T255L64MBO2DBF<DBF<DBF>DBF<DBF"
EXPLODE2: PLAY OFF
CIRCLE (PHASER2, FOCUS2), 10, 13: PAINT (PHASER2, FOCUS2), 14, 13
CIRCLE (PHASER2, FOCUS2), 10, 0: PAINT (PHASER2, FOCUS2), 0, 0
IF QRK = 0 THEN FOR DELAY = 1 TO 1000: NEXT DELAY: GOTO LOSE
IF ADV = 0 THEN FOR DELAY = 1 TO 1000: NEXT DELAY: GOTO WIN
PHASER2 = 1000: KEY(0) ON: RETURN

BRAKE:
KEY(0) OFF
HORZ = 0
VERT = 0
KEY(0) ON: RETURN

WARP:
IF MID$(ITEM$, 3, 1) <> "1" THEN RETURN
KEY(0) OFF
FOR DISAPPEAR = 1 TO 5
IF QUARK$ = "RIGHT" THEN PUT (A - 7, B - 6), QUARKR
IF QUARK$ = "LEFT" THEN PUT (A - 7, B - 6), QUARKL
SOUND DISAPPEAR * 100, 1
IF QUARK$ = "RIGHT" THEN PUT (A - 7, B - 6), QUARKR
IF QUARK$ = "LEFT" THEN PUT (A - 7, B - 6), QUARKL
NEXT DISAPPEAR
IF QUARK$ = "RIGHT" THEN PUT (A - 7, B - 6), QUARKR
IF QUARK$ = "LEFT" THEN PUT (A - 7, B - 6), QUARKL
RANDOMIZE TIMER: A = INT(RND * 291) + 10
RANDOMIZE TIMER: B = INT(RND * 161) + 20
FOR APPEAR = 5 TO 1 STEP -1
IF QUARK$ = "RIGHT" THEN PUT (A - 7, B - 6), QUARKR
IF QUARK$ = "LEFT" THEN PUT (A - 7, B - 6), QUARKL
SOUND APPEAR * 100, 1
IF QUARK$ = "RIGHT" THEN PUT (A - 7, B - 6), QUARKR
IF QUARK$ = "LEFT" THEN PUT (A - 7, B - 6), QUARKL
NEXT APPEAR
IF QUARK$ = "RIGHT" THEN PUT (A - 7, B - 6), QUARKR
IF QUARK$ = "LEFT" THEN PUT (A - 7, B - 6), QUARKL
KEY(0) ON: RETURN


100
KEY(0) OFF
VERT = VERT - 1
KEY(0) ON: RETURN

200
KEY(0) OFF
HORZ = HORZ - 1
IF QUARK$ = "RIGHT" THEN PUT (A - 7, B - 6), QUARKR: QUARK$ = "LEFT": PUT (A - 7, B - 6), QUARKL
KEY(0) ON: RETURN

300
KEY(0) OFF
HORZ = HORZ + 1
IF QUARK$ = "LEFT" THEN PUT (A - 7, B - 6), QUARKL: QUARK$ = "RIGHT": PUT (A - 7, B - 6), QUARKR
KEY(0) ON: RETURN

400
KEY(0) OFF
VERT = VERT + 1
KEY(0) ON: RETURN

WIN:
CLS
PRINT "YEAH!"
SOUND 1000, 5
FOR SUSPEND = 1 TO 2000
BABBLE$ = INKEY$
NEXT SUSPEND
IF MID$(PLANET$, 15, 2) = "20" THEN CHAIN "QUARKVE2.BAS"
CHAIN "QUARKVEN.BAS"

LOSE:
CLS
PRINT "#@$!@"
SOUND 1000, 5
FOR SUSPEND = 1 TO 2000
BABBLE$ = INKEY$
NEXT SUSPEND
CHAIN "LOSE.BAS"

