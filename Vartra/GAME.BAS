COMMON PROGRESS$, SPEED, BOOMERANG, MAX, MAN, ROOM, CASTLE, X, Y, PX, PY, FACE$, STEPS, MONEY, KEYS, ITEM$, sound$, NAME$, COUNTRY$, SAVEFILE$

SCREEN 13: CLS
MAGMA = 40: FLOW = 4
'PLAY "MST200L8O5GL64<<G>>L8AL64<<A>>L8BL64<<B>>L8AL64<<A>>L8GL64<<G>>L8BL64<<B>>L8AL64<<A>>L8BL64<<>C>>L2C"
'TIME = TIMER + 1: WHILE TIMER < TIME: WEND
sound$ = "NOISE"
BOOM$ = "MsT255L64MBO4cO2FMN": IF sound$ = "MUTE" THEN BOOM$ = ""
RECORDERMUSIC$ = "MFT80O4MLL64GF#GF#>CBCBED#ED#GF#GF#GF#GF#ED#ED#GF#GF#GF#GF#GF#GF#P1": IF sound$ = "MUTE" THEN RECORDERMUSIC$ = ""
POW2$ = "t255l64o1mlcgdafe>cgdafe<cgdafemn": IF sound$ = "MUTE" THEN POW2$ = ""
POW1$ = "t255l64o3msccccc<bbbb<aaa<gg<ff<e": IF sound$ = "MUTE" THEN POW1$ = ""
WARP$ = "T255L64MSO3CD>CD>CDO3EF>EF>EFO3GA>GA>GAMN": IF sound$ = "MUTE" THEN WARP$ = ""
SHUTTERNOISE$ = "T255L64O2MLCBCACGCFCECDCMN": IF sound$ = "MUTE" THEN SHUTTERNOISE$ = ""
GETHEART$ = "T255mnL64O5CEGB": IF sound$ = "MUTE" THEN GETHEART$ = ""
GETKEY$ = "T255mnL64O6CEFGBDEFB": IF sound$ = "MUTE" THEN GETKEY$ = ""
OPENLOCK$ = "T255mnL64O2CEFECFECEFCE": IF sound$ = "MUTE" THEN OPENLOCK$ = ""
getchest$ = "t255l32mlo3cdefedefgfefgagfgabagmn": IF sound$ = "MUTE" THEN getchest$ = ""
HAMMERSTRIKE$ = "T255MLL64O2CDEFGGABBGFEDCCCCCC<BBFEDMN": IF sound$ = "MUTE" THEN HAMMERSTRIKE$ = ""
POP$ = "T255L50MSCDEDECDCEDDCEDE": IF sound$ = "MUTE" THEN POP$ = ""
DREAD$ = "p4mfmso2t60l40c<bms>b>>l4<c<l52mlbgfedc<l8bl3ms>cp16": IF sound$ = "MUTE" THEN DREAD$ = ""
GULP$ = "t255l40mlo2ccdeefggabbgecp32ccdeefggabbgecp32ccdeffgabbgec": IF sound$ = "MUTE" THEN GULP$ = ""
SECRET$ = "MLO5L45T255P2EDEDCCDCDEFEFGBAB>CCCCCC": IF sound$ = "MUTE" THEN SECRET$ = ""
SPLUT$ = "MST255L64O1bC": IF sound$ = "MUTE" THEN SPLUT$ = ""
PAUSE$ = "MNL16T200O2CECG."

'                          ***SCENE IMAGES***
'LIGHT color  = SCOLOR1$
'MEDIUM color = SCOLOR2$
'DARK color   = SCOLOR3$
IF CASTLE <= 1 THEN SCOLOR1$ = "010": SCOLOR2$ = "002": SCOLOR3$ = "120"
IF CASTLE = 2 THEN SCOLOR1$ = "032": SCOLOR2$ = "001": SCOLOR3$ = "105"
IF CASTLE = 3 THEN SCOLOR1$ = "038": SCOLOR2$ = "004": SCOLOR3$ = "110"
IF CASTLE = 4 THEN SCOLOR1$ = "036": SCOLOR2$ = "035": SCOLOR3$ = "034"
IF CASTLE = 5 THEN SCOLOR1$ = "029": SCOLOR2$ = "028": SCOLOR3$ = "026"
IF CASTLE = 6 THEN SCOLOR1$ = "014": SCOLOR2$ = "043": SCOLOR3$ = "042"
IF CASTLE = 0 OR CASTLE > 6 THEN SCOLOR1$ = "024": SCOLOR2$ = "022": SCOLOR3$ = "020"




METER$ = "LIFE"
ITEM = 1
STEPS = 1

BLOCK$ = "BM0,30CxxxF9BL9E9G3L3D3R3U4CxxxL3HR5EL7GD7EU5FD3FCxxxR3FL5GR7EU7GD5HU3"
PILLAR$ = "BM10,30BM+3,+7CxxxGDR5UHGLEU6FEUL5DFEBLCxxxD0BR3D0BD7D0BL3D0EU5BM+2,-1CxxxD0BD7D0"
DOOR$ = "BM20,30BR2CxxxR4F2D7BL8U7EBM+2,+4DBR2ULCxxxU4D8BM+3,-1D0BU5D0BL6D0BD5DCxxxR2ULHR2HLURHR2ULHR2ULBR3RGR2GLDR2DLDRDL2DRGR2CxxxBR2U9GULBL6LDCxxxURBR6CxxxRDBM+1,+4D3"
BRICKWALL$ = "BM30,30CxxxR9D9L9U9BFPxxx,xxxCxxxHR3L3D2BM+9,+3L3D2EBM-7,-2CxxxR9NU4L4D5NL5R4"
STAIRCASE$ = "BM40,30CxxxR9D9L9U9BFCxxxRND7FRND6FRND5FRD4CxxxBLNU3BL2NU4BL2NU5BL2U6"
STATUE$ = "BM10,30BRCxxxFDLE2R3FNEFLBL2LUCxxxRF2LDL3ULEUCxxxD0BR3D0BG2R"
ROCK$ = "BM50,30BD2CxxxE2R5F2D5G2L5H2U5BRPxxx,xxxCxxxD0BR2FDBM-2,+1FBR4GNLBU3D0BM+1,-2U"
TOMB$ = "BM60,30BR4C24RF3D3FD2L9U2EU3E2BD6NLR4BUP24,24BD2P22,24BH3BDC20U4GR3C22NHGD2"
LOCK$ = "BM70,30BR3CxxxR3FD3BL5NU3DCxxxLD4R7U4L6D3R5U2L4DR2NRCxxxDHURBM+1,-2U3L3D3"
BARRIER$ = "BM80,30BDCxxxNR9BD3NR9BD3NR9DCxxxNR9BU3NR9BU3NR9BM+1,-2ND9BR3ND9BR3ND9BRCxxxND9BL3ND9BL3ND9"
TREE$ = "BM90,30C117BFBDER5L2DRFEDL5ULGFR3BR2RGL2FBM-5,-1FEDRDC112D2LR3LU2"
GRASS$ = "BM100,30C117bf2dbf2dbf2dc116bm-5,-1ubm+4,-5ubf3d"
MOUNT$ = "BM110,30C21R9D9L9U8BRP21,21EC20F2DFBL3GHBD5EBM+3,-1FDBR2E2BM-2,-4UHE"
MOUNTL$ = "BM120,30C21R9D9L7H2U6BRP21,21EC20F2DFBL3GHBD5BEBM+3,-1FDBR2E2BM-2,-4UHE"
MOUNTR$ = "BM130,30C21R9D7G2L7U8BRP21,21EC20F2DFBL3GHBD5EBM+3,-1FDBR2E2BM-2,-4UHE"
MOUNTT$ = "BM140,30C21R9D9L9U8BRP21,21HC0DED2FU3RBR2DFU2R3DL2FRG2C20D0BM+2,+3D0BL2H3EBD2G3NDBH2EBM-1,-3C22D0BM+3,-1EDFBR2D0"
LADDER$ = "BM150,30C22D9BR9U9BLC21D9BL7U9BDC20NR7BD5NR7"
CAVE$ = "BM160,30C18R9D9L9U8BRP18,18BHC22BD9U3RU2HU2EFUR3ND3F2U2R2DBM-3,-1C21D0BL6D0BD4D"
SIGN$ = "BM170,30BM+4,+9C6U5C7NL2R2UL4R2UC6D0"
MONUMENT$ = "BM180,30CxxxBD9U7END8RUR4F2D7L6BM+1,-2Pxxx,xxxCxxxRBR2D0BU2HGHBU2R3BM+1,+7CxxxL5"
CHEST$ = "BM190,30BD4C43D3F2U3NHD3R6U3NL5U1H2L5BDP4,43BD3P4,43BR2P4,43BR2C8D0"
SHRUBS$ = "BM200,30BDC190D2RNU3RNU3RNU3RNU2F2D2NU4RNU4RNU4EU3C118ULULDLUGDGNL3FNL5DNL5DNL5GL3FC112RBM+3,-1R"
WATER$ = "BM210,30C1D9R9U9L8BDP1,1BHC55RFRFRFRFRBU4NLBD8LHLHLHLHLBD4RFRBR4C9LHLHLHLBU4RFRFRFRFRBU4LHLHL"
CAVEWALL$ = "BM220,30C114R9D9L9U8BRP114,114EC19F2DFBL3GHBD5EBM+3,-1FDBR2E2BM-2,-4UHE"
LAVA$ = "BM230,30C42D9R9U9L8BDP42,42BHC43RFRFRFRFRBU4NLBD8LHLHLHLHLBD4RFRBR4C44LHLHLHLBU4RFRFRFRFRBU4LHLHL"
MAN$ = "BM240,30BR3C6NDR3GC9LC65GR2GRC1RFL6ERD2R2DC8NL2DBL2D2LBR4LUC7D0BL2D0BM-2,-3C65D0BR6D0"
LADY$ = "BM250,30BR3C6RFL2GDEC1R2GC64UC65GFEFC5D0BL4DC65D0BR4DC15D0BL4RC5R2UC13UGLUBD3R2FL4DR4BLC5D0BL2D0"
GEEZER$ = "BM260,30BR3C65NGR2NGFGL2FBLC7DRDEUBU2C8D0BL2D0BD4C6L2URUBR4FDHDLFC8L4BD3LR2BR2R2HC6L4UR4GC65D0BL2D0BH2D0BM+7,-2D3C8U2BU2EUL"
MERCHANT$ = "BM270,30BF2C8URUR3FLC7L2BG2D0BBM+2,-1C1D0BR2DC65HDLBG3D0BR7UC2L7ENR5BM+1,+2R3BD3C8R2HBL4GR2UC5ULBR4NGNLBH2NENH"
INCAVE$ = "BM280,30C1R9D9L9U8BRP1,1BHC114BD9U3RU2HU2EFUR3ND3F2U2R2DBM-3,-1C19D0BL6D0BD4D"
BEACHUL$ = "BM290,30C1D9R9U9L8BDP1,1BHC55RFRFRFRFRBU4NLBD8LHLHLHLHLBD4RFRBR4C9LHLHLHLBU4RFRFRFRFRBU4LHLHLC0L2DHND2LD4"
BEACHUR$ = "BM300,30C1D9R9U9L8BDP1,1BHC55RFRFRFRFRBU4NLBD8LHLHLHLHLBD4RFRBR4C9LHLHLHLBU4RFRFRFRFRBU4LHLHLBRC0R4DNL2DNLD2"
BEACHDL$ = "BM310,30C1D9R9U9L8BDP1,1BHC55RFRFRFRFRBU4NLBD8LHLHLHLHLBD4RFRBR4C9LHLHLHLBU4RFRFRFRFRBU4LHLHLBM-4,+5C0D4RNU2RNUR2"
BEACHDR$ = "BM0,40C1D9R9U9L8BDP1,1BHC55RFRFRFRFRBU4NLBD8LHLHLHLHLBD4RFRBR4C9LHLHLHLBU4RFRFRFRFRBU4LHLHLBM+1,+9C0R4UNL2UNLU2"
KID$ = "BM10,40BM+3,+2C6R2DC1L2RC65DNLRFDL4UC12NR4FR2G2C7UR2D2C8NRBL2L"
GOLDBLOCK$ = "BM20,40C43F9BL9E9G3L3D3R3U4C14L3HR5EL7GD7EU5FD3FC42R3FL5GR7EU7GD5HU3"
GOLDPILLAR$ = "BM30,40BM+3,+7C43GDR5UHGLEU6FEUL5DFEBLC14D0BR3D0BD7D0BL3D0EU5BM+2,-1C42D0BD7D0"
GOLDDOOR$ = "BM40,40BR2C42R4F2D7BL8U7EBM+2,+4DBR2ULC43U4D8BM+3,-1D0BU5D0BL6D0BD5DC14R2ULHR2HLURHR2ULHR2ULBR3RGR2GLDR2DLDRDL2DRGR2C42BR2U9GULBL6LDC14URBR6C43RDBM+1,+4D3"
GOLDBRICK$ = "BM50,40C43R9D9L9U9BFP43,43C14HR3L3D2BM+9,+3L3D2EBM-7,-2C42R9NU4L4D5NL5R4"
GOLDSTATUE$ = "BM30,40BRC42FDLE2R3FNEFLBL2LUC43RF2LDL3ULEUC14D0BR3D0BG2R"

MID$(BLOCK$, 8, 3) = SCOLOR2$: MID$(BLOCK$, 29, 3) = SCOLOR1$: MID$(BLOCK$, 51, 3) = SCOLOR3$
MID$(PILLAR$, 16, 3) = SCOLOR2$: MID$(PILLAR$, 41, 3) = SCOLOR1$: MID$(PILLAR$, 72, 3) = SCOLOR3$
MID$(DOOR$, 12, 3) = SCOLOR3$: MID$(DOOR$, 41, 3) = SCOLOR2$: MID$(DOOR$, 72, 3) = SCOLOR1$: MID$(DOOR$, 121, 3) = SCOLOR3$: MID$(DOOR$, 138, 3) = SCOLOR1$: MID$(DOOR$, 147, 3) = SCOLOR2$
MID$(BRICKWALL$, 9, 3) = SCOLOR2$: MID$(BRICKWALL$, 23, 3) = SCOLOR2$: MID$(BRICKWALL$, 27, 3) = SCOLOR2$: MID$(BRICKWALL$, 31, 3) = SCOLOR1$: MID$(BRICKWALL$, 61, 3) = SCOLOR3$
MID$(STAIRCASE$, 9, 3) = SCOLOR3$: MID$(STAIRCASE$, 23, 3) = SCOLOR2$: MID$(STAIRCASE$, 45, 3) = SCOLOR1$
MID$(STATUE$, 11, 3) = SCOLOR3$: MID$(STATUE$, 32, 3) = SCOLOR2$: MID$(STATUE$, 47, 3) = SCOLOR1$
MID$(ROCK$, 12, 3) = SCOLOR2$: MID$(ROCK$, 34, 3) = SCOLOR1$: MID$(ROCK$, 38, 3) = SCOLOR2$: MID$(ROCK$, 42, 3) = SCOLOR3$
MID$(LOCK$, 12, 3) = SCOLOR1$: MID$(LOCK$, 28, 3) = SCOLOR2$: MID$(LOCK$, 54, 3) = SCOLOR3$
MID$(BARRIER$, 11, 3) = SCOLOR3$: MID$(BARRIER$, 31, 3) = SCOLOR1$: MID$(BARRIER$, 74, 3) = SCOLOR2$
MID$(MONUMENT$, 10, 3) = SCOLOR2$: MID$(MONUMENT$, 40, 3) = SCOLOR1$: MID$(MONUMENT$, 44, 3) = SCOLOR2$: MID$(MONUMENT$, 48, 3) = SCOLOR3$: MID$(MONUMENT$, 76, 3) = SCOLOR1$

DRAW BLOCK$
DRAW PILLAR$
DRAW DOOR$
DRAW BRICKWALL$
DRAW STAIRCASE$
DRAW ROCK$
DRAW TOMB$
DRAW LOCK$
DRAW BARRIER$
DRAW TREE$
DRAW GRASS$
DRAW MOUNT$
DRAW MOUNTL$
DRAW MOUNTR$
DRAW MOUNTT$
DRAW LADDER$
DRAW CAVE$
DRAW SIGN$
DRAW MONUMENT$
DRAW CHEST$
DRAW SHRUBS$
DRAW WATER$
DRAW CAVEWALL$
DRAW LAVA$
DRAW MAN$
DRAW LADY$
DRAW GEEZER$
DRAW MERCHANT$
DRAW INCAVE$
DRAW BEACHUL$
DRAW BEACHUR$
DRAW BEACHDL$
DRAW BEACHDR$
DRAW KID$
DRAW GOLDBRICK$
DRAW GOLDPILLAR$
DRAW GOLDBLOCK$
DRAW GOLDDOOR$
DIM BLOCK(1 TO 26): GET (0, 30)-(9, 39), BLOCK
DIM PILLAR(1 TO 26): GET (10, 30)-(19, 39), PILLAR
DRAW STATUE$
DIM DOOR(1 TO 26): GET (20, 30)-(29, 39), DOOR
DIM BRICKWALL(1 TO 26): GET (30, 30)-(39, 39), BRICKWALL
DIM STAIRCASE(1 TO 26): GET (40, 30)-(49, 39), STAIRCASE
DIM STATUE(1 TO 26): GET (10, 30)-(19, 39), STATUE
DIM ROCK(1 TO 26): GET (50, 30)-(59, 39), ROCK
DIM TOMB(1 TO 26): GET (60, 30)-(69, 39), TOMB
DIM KEYLOCK(1 TO 26): GET (70, 30)-(79, 39), KEYLOCK
DIM BARRIER(1 TO 26): GET (80, 30)-(89, 39), BARRIER
DIM TREE(1 TO 26): GET (90, 30)-(99, 39), TREE
DIM GRASS(1 TO 26): GET (100, 30)-(109, 39), GRASS
DIM MOUNT(1 TO 26): GET (110, 30)-(119, 39), MOUNT
DIM MOUNTL(1 TO 26): GET (120, 30)-(129, 39), MOUNTL
DIM MOUNTR(1 TO 26): GET (130, 30)-(139, 39), MOUNTR
DIM MOUNTT(1 TO 26): GET (140, 30)-(149, 39), MOUNTT
DIM LADDER(1 TO 26): GET (150, 30)-(159, 39), LADDER
DIM CAVE(1 TO 26): GET (160, 30)-(169, 39), CAVE
DIM SIGN(1 TO 26): GET (170, 30)-(179, 39), SIGN
DIM MONUMENT(1 TO 26): GET (180, 30)-(189, 39), MONUMENT
DIM CHEST(1 TO 26): GET (190, 30)-(199, 39), CHEST
DIM SHRUB(1 TO 26): GET (200, 30)-(209, 39), SHRUB
DIM WATER(1 TO 26): GET (210, 30)-(219, 39), WATER
DIM CAVEWALL(1 TO 26): GET (220, 30)-(229, 39), CAVEWALL
DIM LAVA(1 TO 26): GET (230, 30)-(239, 39), LAVA
DIM MAN(1 TO 26): GET (240, 30)-(249, 39), MAN
DIM LADY(1 TO 26): GET (250, 30)-(259, 39), LADY
DIM GEEZER(1 TO 26): GET (260, 30)-(269, 39), GEEZER
DIM MERCHANT(1 TO 26): GET (270, 30)-(279, 39), MERCHANT
DIM INCAVE(1 TO 26): GET (280, 30)-(289, 39), INCAVE
DIM BEACHUL(1 TO 26): GET (290, 30)-(299, 39), BEACHUL
DIM BEACHUR(1 TO 26): GET (300, 30)-(309, 39), BEACHUR
DIM BEACHDL(1 TO 26): GET (310, 30)-(319, 39), BEACHDL
DIM BEACHDR(1 TO 26): GET (0, 40)-(9, 49), BEACHDR
DIM KID(1 TO 26): GET (10, 40)-(19, 49), KID
DIM GOLDBLOCK(1 TO 26): GET (20, 40)-(29, 49), GOLDBLOCK
DIM GOLDPILLAR(1 TO 26): GET (30, 40)-(39, 49), GOLDPILLAR
DRAW GOLDSTATUE$
DIM GOLDDOOR(1 TO 26): GET (40, 40)-(49, 49), GOLDDOOR
DIM GOLDBRICK(1 TO 26): GET (50, 40)-(59, 49), GOLDBRICK
DIM GOLDSTATUE(1 TO 26): GET (30, 40)-(39, 49), GOLDSTATUE

'                           ***HERO IMAGE***
DRAW "BM0,0BR3C6R2NRDc1D0BLC65LDR2GDc4L2GC65D0BM+6,-2Gc4L2D2c9RDL3C65LC15DBR4DRHC65D0"
DIM MAN1R(1 TO 26): GET (0, 0)-(9, 9), MAN1R
DRAW "BM10,0BR3C6R2NRDc1LC65LDR2GDc4DEL2GC65D0BR4Gc9LDRGC65FC15LHG"
DIM MAN2R(1 TO 26): GET (10, 0)-(19, 9), MAN2R
DRAW "BM25,0C6L2NLDc1D0BRC65RDL2FDc4R2FC65D0BM-6,-2Fc4R2D2c9LDR3C65RC15DBL4DLEC65D0"
DIM MAN1L(1 TO 26): GET (20, 0)-(29, 9), MAN1L
DRAW "BM30,0BR5C6L2NLDc1RC65RDL2FDc4DHR2FC65D0BL4Fc9RDLFC65GC15REF"
DIM MAN2L(1 TO 26): GET (30, 0)-(39, 9), MAN2L
DRAW "BM40,0BR3C6R2Dc64ngc1L2RC65GFNEDc4DERL4HC65D0BM+6,+2D0BM-2,+1c9DHLDC65DC15LBR3DRHC65D0"
DIM MAN1D(1 TO 26): GET (40, 0)-(49, 9), MAN1D
DRAW "BM50,0BR5C6L2Dc64nfc1R2LC65FGNHDc4DHLR4EC65D0BM-6,+2D0BM+2,+1c9DERDC65DC15RBL3DLEC65D0"
DIM MAN2D(1 TO 26): GET (50, 0)-(59, 9), MAN2D
DRAW "BM60,0BR3C6R2DC65L2DR2GDc4DERL4HC65D0BM+6,+2D0BM-2,+1c9DHLDC65DC15LBR3DRHC65D0"
DIM MAN1U(1 TO 26): GET (60, 0)-(69, 9), MAN1U
DRAW "BM70,0BR5C6L2DC65R2DL2FDc4DHLR4EC65D0BM-6,+2D0BM+2,+1c9DERDC65DC15RBL3DLEC65D0"
DIM MAN2U(1 TO 26): GET (70, 0)-(79, 9), MAN2U
BOOM1$ = "BM80,0BM+2,+2C7 F4H2E2G4"
IF BOOMERANG = 2 THEN MID$(BOOM1$, 15, 2) = "12"
IF BOOMERANG = 4 THEN MID$(BOOM1$, 15, 2) = "47"
DRAW BOOM1$: DIM BOOM1(1 TO 26): GET (80, 0)-(89, 9), BOOM1
BOOM2$ = "BM90,0BM+4,+2C7 D4U2L2R4"
IF BOOMERANG = 2 THEN MID$(BOOM2$, 15, 2) = "12"
IF BOOMERANG = 4 THEN MID$(BOOM2$, 15, 2) = "32"
DRAW BOOM2$: DIM BOOM2(1 TO 26): GET (90, 0)-(99, 9), BOOM2
DRAW "BM100,0BM+3,+2C5GD2F3E3U2HLGHBGP4,5"
DIM HEART(1 TO 26): GET (100, 0)-(109, 9), HEART
DRAW "BM110,0BM+5,+5C40NU3ND3C42NL3NR3NH3NF3C43NE3NG3"
DIM XPLODE(1 TO 26): GET (110, 0)-(119, 9), XPLODE
DRAW "BM160,0BM+1,+2C14ND2R2DGRER2NDR2DLC42D0BM-5,-1D0"
DIM LOCKKEY(1 TO 26): GET (160, 0)-(169, 9), LOCKKEY
DRAW "BM170,0BM+2,+3C42ND2ER2BD2GLC43DR2URU2L3DR"
DIM COIN(1 TO 26): GET (170, 0)-(179, 9), COIN


DRAW "BM200,0BFC12D7EU5FD3EU"
DIM SELECTOR(1 TO 20): GET (200, 0)-(205, 9), SELECTOR

1
GOSUB SCREEN4SCENE
'                          ***MONSTER IMAGE***
PALETTE 16, 0
OPEN FILESPEC$ FOR INPUT AS #1
INPUT #1, MONSTER$
INPUT #1, NUMBER
IF CASTLE = 1 AND ROOM = 203 THEN IF MID$(PROGRESS$, 1, 1) = "X" THEN MONSTER$ = "NONE"
IF CASTLE = 2 AND ROOM = 101 THEN IF MID$(PROGRESS$, 2, 1) = "X" THEN MONSTER$ = "NONE"


IF MONSTER$ = "BAT" THEN MONSTER1$ = "BM120,6BM+3,+1C7FRNEFR2NFG2UL4FU2L2GBM+4,-1C8RBD5RL3": MLIFE = 1: MATTACK = 1: BEHAVIOR$ = "OOOO"
IF MONSTER$ = "BAT" THEN MONSTER2$ = "BM130,6BM+3,+1C7FRNEFRDLFGBL3HURHR2C8RBD5C8L"
IF MONSTER$ = "GOBLIN" THEN MONSTER1$ = "BM120,6BM+3,+2C2FRNEDLD3GNHERFDRH2UC8NLUC2RC4EC15EBM-6,+2C6RDL": MLIFE = 2: MATTACK = 1: BEHAVIOR$ = "XOOO"
IF MONSTER$ = "GOBLIN" THEN MONSTER2$ = "BM130,6BM+3,+2C2FRNEDLD3G2RUBR3EBL2UC8NLUC2RC4RC15RBL6C6RDL"
IF MONSTER$ = "BLOB" THEN MONSTER1$ = "BM120,6BM+4,+1C3RFL3FRF3D2GL5HU2E2BM-1,+3P3,3C11FR3EBM-1,-4D0BL3D0": MLIFE = 2: MATTACK = 2: BEHAVIOR$ = "OXOO"
IF MONSTER$ = "BLOB" THEN MONSTER2$ = "BM130,6BM+4,+1C3RFDFD4GL3HU4EUBFP3,3C11RBD3FGLHE"
IF MONSTER$ = "SKELETON" THEN MONSTER1$ = "BM120,6BR4C30RFL3DR3GNLFRNELGLHLNGBM+1,+2FREF2LBL5UD2LBM+3,-7C7R": MLIFE = 1: MATTACK = 3: BEHAVIOR$ = "XOOO"
IF MONSTER$ = "SKELETON" THEN MONSTER2$ = "BM130,6BR5C30LGR3DL3FNRGLNHRFRERNFBM-1,+2GLHG2RBR5UD2RBM-3,-7C7L"
IF MONSTER$ = "LIZARD" THEN MONSTER1$ = "BM120,6BR3C4F2RFBL2FD2REBG3FUL2DBU3LGE2UHUGHBR3C12NHDFD3LC8D0BR2D0": MLIFE = 3: MATTACK = 2: BEHAVIOR$ = "OOOO"
IF MONSTER$ = "LIZARD" THEN MONSTER2$ = "BM130,6BR5C4GFDREG2F3HLBD2GULBU2NULHEU2LGBR3C12UNED2FD2LC8D0BR2D0"
IF MONSTER$ = "SOLDIER" THEN MONSTER1$ = "BM120,6BR4C6RFNDL3DBM-2,+1GDFU2RDBM-1,+4EDRBM+3,-1R2HEUBU2U2C7RHBM-4,+2C65RDLGC10D0BD2D2BM+3,-1UBU2R2C65D0BL3C2LGR3GL": MLIFE = 2: MATTACK = 2: BEHAVIOR$ = "XOOO"
IF MONSTER$ = "SOLDIER" THEN MONSTER2$ = "BM130,6BR4C6RFNDL3DBL2GDFU2RDBM-1,+4EDRBM+3,+1R2HEUBU2U2C7RHBM-4,+1C65RDLGC10D0BD2DBM+3,-1D2BU4FRC65D0BL2C2HLGR2DL"
IF MONSTER$ = "PIGEON" THEN MONSTER1$ = "BM120,6BM+3,+1C14ERFBD2R3L9FR7GC65LBL3LBE3LUC7RC8BD6RL3": MLIFE = 2: MATTACK = 1: BEHAVIOR$ = "XOOO"
IF MONSTER$ = "PIGEON" THEN MONSTER2$ = "BM130,6BM+3,+1C14ERFBD2RD2NDH2DHDHDHD3EC65D0BR3D0BM-1,-3LUC7RC8BD6L"
IF MONSTER$ = "DEVIL" THEN MONSTER1$ = "BM120,6C12NF9BD2C13REUBM+3,+2C9D0BR3D0BM-4,-2C4DR5UG2LGR3GLDR3DL2F2GBL3LURELUH": MLIFE = 4: MATTACK = 2: BEHAVIOR$ = "OOXO"
IF MONSTER$ = "DEVIL" THEN MONSTER2$ = "BM130,6C13NF9BD2C12REUBM+3,+2C1D0BR3D0BM-4,-2C4DR5UG2LGR3GLDR3DL2F2GBL3LURELUH": SHOT$ = "BM140,6BM+3,+2C42d0bm+2,+1gbm+2,+1gdlhrc41uebm+1,+2bh3dc43dbr2d0"
IF MONSTER$ = "OGRE" THEN MONSTER1$ = "BM120,6BR2C2RDR3ELDGNFLGDNL2R5DL7R2DR3BD2RDLBL3ULDLC10D0BR7D0BU3EBL3D0BL3D0BL3FBM+2,+1C12R3GLBU5C29REC4D0BL3D0 ": MLIFE = 5: MATTACK = 3: BEHAVIOR$ = "XXOO"
IF MONSTER$ = "OGRE" THEN MONSTER2$ = "BM130,6BR2C2RDR3ELDGNFLGDNL2R5DL7R5BD2RDLBL3ULDLC10D0BR7D0BU5NFBG2D0BL3D0BH2GBM+3,+2C12R3GLBU4C29REC4D0BL3D0"
IF MONSTER$ = "CRAWLER" THEN MONSTER1$ = "BM120,6BRC6DLR2BR5RDRBD5L2ELBL5DHD2HDBR3ERFGC7LBU3R2URU3LUL3DLD3RDBEP8,7C8BH3LBD7RBM+7,-1RBU5LBM-4,+5C14RC4D0": MLIFE = 6: MATTACK = 2: BEHAVIOR$ = "OOOO"
IF MONSTER$ = "CRAWLER" THEN MONSTER2$ = "BM130,6BR8C6DRL2BL5LDLBD5R2HRBR5DED2EDBL3HLGFC7RBU3L2ULU3RUR3DRD3LDBHP8,7C8BE3RBD7LBM-7,-1LBU5RBM+4,+5C14LC4D0"
IF MONSTER$ = "FAUN" THEN MONSTER1$ = "BM120,6BR3C6R2BD3L2FBM+2,+1DGUL3DRDBU3C65HUNL2F2RURURFBM-3,-2NEHDLHRC4D0BR2D0BM+3,+1C15DBM-8,-1UBD3C8D0BM+8,+1D0BM-2,+3D0BM-4,+1D0": MLIFE = 6: MATTACK = 4: BEHAVIOR$ = "XOOO"
IF MONSTER$ = "FAUN" THEN MONSTER2$ = "BM130,6BR5C6L2BD3R2GBM-2,+1DFUR3DLDBU3C65EUNR2G2LULULGBM+3,-2NHEDRELC4D0BL2D0BM-3,+1C15DBM+8,-1UBD3C8D0BM-8,+1D0BM+2,+3D0BM+4,+1D0"
IF MONSTER$ = "DINO" THEN MONSTER1$ = "BM120,6BR3C2R3GLGHDR5NUGL3FRBM-2,-3C10D0BR3D0BM+1,+2C65G2LH2GC115RGR2GR5HR2HRFC2DLBL7LUBM+3,+2C110R3FC115L5GC2R2BR3R": MLIFE = 8: MATTACK = 5: BEHAVIOR$ = "XOXO"
IF MONSTER$ = "DINO" THEN MONSTER2$ = "BM130,6BR3C2R3GLGHDR5NUDC65GL3HBM+1,-2C10D0BR3D0BM-5,+3C115RGR2GR5HR2HR2C2DBL9UBM+2,+5RBR3R2HC115L5EC110R3BH2C115RBU2C8RL3": SHOT$ = "BM140,6BM+3,+2C42d0bm+2,+1gbm+2,+1gdlhrc41uebm+1,+2bh3dc43dbr2d0"
IF MONSTER$ = "GHOST" THEN MONSTER1$ = "BM120,6BR2C15GRDR2D3LDLHBR2R2EUERD2EHL2U2LGBFP15,15EC9D0": MLIFE = 6: MATTACK = 4: BEHAVIOR$ = "XOOX"
IF MONSTER$ = "GHOST" THEN MONSTER2$ = "BM130,6BR2C29GRDR2D3LDLHBR2R2EUERD2EHL2U2LGBFP29,29EC9D0": TELEPORT$ = "BM150,6BM+5,+5C15NU3ND3C29NL3NR3NH3NF3C7NE3NG3"
IF MONSTER$ = "MUMMY" THEN MONSTER1$ = "BM120,6BR4C29RBD2RL3BD2L3R6BR3D0BM-3,+2RBM+1,+2D0BL5L2BE2DC28D0BR4RBH2L3BL3D0BE2R7BM-3,-2L3RC9R": MLIFE = 10: MATTACK = 2: BEHAVIOR$ = "XOOO"
IF MONSTER$ = "MUMMY" THEN MONSTER2$ = "BM130,6BR5C29LBD2LR3BD2R3L6BL3D0BM+3,+2LBM-1,+2D0BR5R2BH2DC28D0BL4LBE2R3BR3D0BH2L7BM+3,-2R3LC9L"
IF MONSTER$ = "ZOMBIE" THEN MONSTER1$ = "BM120,6BR4C15RFGLNHDL2GNDEFER3FNDHG2LGR3D3RBL5RU2GC29D0BM+2,-1RBM+2,+1D0BM+1,-2D0BM-1,-2GHLGHBM-1,+2D0BM+2,-4D0BR3D0HC77L": MLIFE = 8: MATTACK = 4: BEHAVIOR$ = "XOXO"
IF MONSTER$ = "ZOMBIE" THEN MONSTER2$ = "BM130,6BR4C29RFGLNHDL2GNDEFER3FNDHG2LGR3D3RBL5RU2GC15D0BM+2,-1RBM+2,+1D0BM+1,-2D0BM-1,-2GHLGHBM-1,+2D0BM+2,-4D0BR3D0HC77L": SHOT$ = "BM140,6BR2C255GRDR2D3LDLHBR2R2EUERD2EHL2U2LG"
IF MONSTER$ = "WIZARD" THEN MONSTER1$ = "BM120,6BR4C33GR2URFGDLDGU2GULNUGD2EDRGDR4UNL3HRUFU2EC34D2BM-1,+3GL4HBM-1,-3U2BM+2,+1C35F2E2BG2C43D0BM+5,-1U4C38D0BD2C2DBM-4,-2L2BM-3,+7RBR6R": MLIFE = 7: MATTACK = 8: BEHAVIOR$ = "OOXX"
IF MONSTER$ = "WIZARD" THEN MONSTER2$ = "BM130,6BR4C33GR2URFGDLDGU2GULNUGD2EDRGDR4UNL3HRUFU2EC34D2BM-1,+3GL4HBM-1,-3U2BM+2,+1C35F2E2BG2C43D0BR5U4C38D0BD2C2DBM-4,-3L2BM-2,+7RBR4R": SHOT$ = "BM140,6BM+2,+1C13GRGR3UFG3UER2DRND2RHR2HU": TELEPORT$ =  _
"BM150,6BM+5,+5C33NU3ND3C34NL3NR3NH3NF3C35NE3NG3"
IF MONSTER$ = "KNIGHT" THEN MONSTER1$ = "BM120,6BR3C1R3GC25LGDR3NUFL4BD2ND2R3D2C23R2HBM-4,+2L2EBU4C21ULGDRDEC1H2BR8C30NU3FC1LDBL2C23L3RC21RBU3C9LGC21D0BR3D0": MLIFE = 12: MATTACK = 6: BEHAVIOR$ = "XOOO"
IF MONSTER$ = "KNIGHT" THEN MONSTER2$ = "BM130,6BR3C1R3GC25LGDR3NUDNFL3BD2NDR3D3C23R2HBL4L2EBU4C21ULGDRDEC1H2BM+8,+2C30NU3FC1GUBL2C23L3RC21RBU3C9LGC21D0BR3D0"
IF MONSTER$ = "PHOENIX" THEN MONSTER1$ = "BM120,6BFC1DLDFED2LFR4DEREHL5DR5C65D0BM-1,+4HGUHGBM-2,-5D0BF5C64D0BM-2,-1D0BU5C13FUEHL2FRC4FC65RBM-2,+2C3NLR2C11GL2H": MLIFE = 14: MATTACK = 5: BEHAVIOR$ = "XOXO"
IF MONSTER$ = "PHOENIX" THEN MONSTER2$ = "BM130,6BM+8,+1C1DRDGHD2RGL4DHLHER5DL5C65D0BM+1,+4EFUEFBM+2,-5D0BG5C64D0BM+2,-1D0BU5C13GUHER2GLC4GC65LBM+2,+2C3NRL2C11FR2E": SHOT$ = "BM140,6BM+2,+3C13EBR2FBD2GBL2HEC14EFGUC12D0"
IF MONSTER$ = "PORTAL" THEN MONSTER1$ = "BM120,6BD4C11E4F4G4H4RC3E3F3G3H3RC9E2F2G2H2RC1EFGHRC0D0": MLIFE = 60: MATTACK = 99: BEHAVIOR$ = "OXOO"
IF MONSTER$ = "PORTAL" THEN MONSTER2$ = "BM130,6BFC11R6D6L6U6FC3R4D4L4U4FC9R2D2L2U2FC1D0"
IF MONSTER$ = "HORNET" THEN MONSTER1$ = "BM120,6BM+2,+3C7UHERFD2RC5DLDBE3LURFDLBUC13D0BGC1D2F2BL3H2NG2U2C15U2LBD3C5LDRBL2C13D0": MLIFE = 2: MATTACK = 4: BEHAVIOR$ = "XOOO"
IF MONSTER$ = "HORNET" THEN MONSTER2$ = "BM130,6BD3C7E2RF2GL2HEC15RGR2BR3C5RUHLDRC13GC1D2NF2HC5GBL2LD2C1E2F2BL2C13D0"
IF MONSTER$ = "SPECTRE" THEN MONSTER1$ = "BM120,6BR2C16GRDR2D3LDLHBR2R2EUERD2EHL2U2LGBFP16,16EC17D0": MLIFE = 12: MATTACK = 4: BEHAVIOR$ = "XOOO"
IF MONSTER$ = "SPECTRE" THEN MONSTER2$ = "BM130,6BR2C16GRDR2D3LDLHBR2R2EUERD2EHL2U2LGBFP16,16EC17D0"
IF MONSTER$ = "LOBSTER" THEN MONSTER1$ = "BM120,6BR2C112RDGNGF2ENHENFHURBD5RD2BL6U2RBFC1R2BGC4U2 NLRURBD3DBR2UBL6DBL2UBE3NLE2BL2EU": MLIFE = 5: MATTACK = 2: BEHAVIOR$ = "OOOO"
IF MONSTER$ = "LOBSTER" THEN MONSTER2$ = "BM130,6BR3C112GRF2BU2NURBD4RND2BU2D0BL6D0BR2FBM-2,+1LD4C4ULUBR4U2LR2BF3GUEBH3RG2NDULUNLE2HNUGBD4C9D0BR2D0"
IF MONSTER$ = "VARTRAGUARD" THEN MONSTER1$ = "BM120,6BR2C24R4FDG2DL2UH2UBRC26DR2NUR2NUGNGNL2BR2D2NHGLDFBL4EULHU2FDC22GHNU2F2G2R3UEFDR3H2ENHEU2bm-3,-2c12D0BL2D0": MLIFE = 24: MATTACK = 4: BEHAVIOR$ = "XOOO"
IF MONSTER$ = "VARTRAGUARD" THEN MONSTER2$ = "BM130,6BR2C24R4FDG2DL2UH2UBRC26DR2NUR2NUGNGNL2BR2D2NHGLDFBL4EULHU2FDC22GHNU2F2G2R3UEFDR3H2ENHEU2U2BL8DC24RBR7D0BD5C22D2C0D0BL2L4BL2UC22UEC0HBRC22D0BR6RC0Gbm133,7c14d0br2d0"
IF MONSTER$ = "BOSS" THEN CLOSE #1: CHAIN "BOSS.BAS"
IF MONSTER$ = "NONE" THEN MONSTER1$ = "": MONSTER2$ = "": MLIFE = 0: NUMBER = 0


DIM MONSTER2(1 TO 100): DIM MONSTER1(1 TO 100)
DRAW MONSTER1$
GET (120, 6)-(129, 15), MONSTER1
DRAW MONSTER2$
GET (130, 6)-(139, 15), MONSTER2
IF MID$(BEHAVIOR$, 3, 1) = "X" THEN DRAW SHOT$: DIM SHOT(1 TO 26): GET (140, 6)-(149, 15), SHOT
IF MID$(BEHAVIOR$, 4, 1) = "X" THEN DRAW TELEPORT$: DIM TELE(1 TO 26): GET (150, 6)-(159, 15), TELE




M1L = MLIFE: M1D = 4: M1M = 0: M1P = 1: PAUSE1 = 1
M2L = MLIFE: M2D = 4: M2M = 0: M2P = 1: PAUSE2 = -1
M3L = MLIFE: M3D = 4: M3M = 0: M3P = 1: PAUSE3 = 1
IF NUMBER < 3 THEN M3L = 0
IF NUMBER < 2 THEN M2L = 0

CLS
GOSUB SETBOUNDS
GOSUB READBITMAP
IF ROOM = 212 AND X = 17 AND Y = 7 THEN PSET (X, Y), 0: PUT (X * 10, Y * 10), ROCK, XOR
GOSUB PLACEME
IF M1L = 0 THEN GOTO 5
2 RANDOMIZE TIMER: M1X = INT(RND * 20) + 9: M1Y = INT(RND * 14) + 3: IF POINT(M1X, M1Y) <> 0 THEN GOTO 2
IF M1X <= X + 3 AND M1X >= X - 3 THEN IF M1Y <= Y + 3 AND M1Y >= Y - 3 THEN PRESET (M1X, M1Y), 0: GOTO 2
IF M2L = 0 THEN GOTO 5
3 RANDOMIZE TIMER: M2X = INT(RND * 20) + 9: M2Y = INT(RND * 14) + 3: IF POINT(M2X, M2Y) <> 0 THEN GOTO 3
IF M2X <= X + 3 AND M2X >= X - 3 THEN IF M2Y <= Y + 3 AND M2Y >= Y - 3 THEN PRESET (M2X, M2Y), 0: GOTO 3
IF M3L = 0 THEN GOTO 5
4 RANDOMIZE TIMER: M3X = INT(RND * 20) + 9: M3Y = INT(RND * 14) + 3: IF POINT(M3X, M3Y) <> 0 THEN GOTO 4
IF M3X <= X + 3 AND M3X >= X - 3 THEN IF M3Y <= Y + 3 AND M3Y >= Y - 3 THEN PRESET (M3X, M3Y), 0: GOTO 4

5
IF CASTLE = 0 AND ROOM = 710 THEN M1X = 23: M1Y = 11
IF CASTLE = 0 AND ROOM = 810 AND MID$(PROGRESS$, 5, 1) = "O" THEN M1X = 16: M2X = 17: M3X = 18: M1Y = 13: M2Y = 13: M3Y = 13
IF CASTLE = 0 AND ROOM = 810 AND MID$(PROGRESS$, 5, 1) = "X" THEN M1L = 0: M2L = 0: M3L = 0: MLIFE = 0: MONSTER$ = "NONE"
M1PX = M1X: M1PY = M1Y: M2PX = M2X: M2PY = M2Y: M3PX = M3X: M3PY = M3Y

IF M1L > 0 THEN PUT (M1X * 10, M1Y * 10), MONSTER1, XOR: PSET (M1X, M1Y), 2
IF M2L > 0 THEN PUT (M2X * 10, M2Y * 10), MONSTER1, XOR: PSET (M2X, M2Y), 2
IF M3L > 0 THEN PUT (M3X * 10, M3Y * 10), MONSTER1, XOR: PSET (M3X, M3Y), 2
6

KEY 15, CHR$(128) + CHR$(72)
KEY 16, CHR$(128) + CHR$(75)
KEY 17, CHR$(128) + CHR$(77)
KEY 18, CHR$(128) + CHR$(80)
KEY 19, CHR$(128) + CHR$(&H1D)
KEY 20, CHR$(&H0) + CHR$(54)
KEY 21, CHR$(&H0) + CHR$(&H39)
KEY 22, CHR$(128) + CHR$(&H38)
KEY 23, CHR$(0) + CHR$(25)
KEY 24, CHR$(4) + CHR$(37)

ON KEY(15) GOSUB UPME
ON KEY(16) GOSUB LEFTME
ON KEY(17) GOSUB RIGHTME
ON KEY(18) GOSUB DOWNME
ON KEY(19) GOSUB BOOM
ON KEY(20) GOSUB SWITCH
ON KEY(21) GOSUB SWITCHMETER
ON KEY(22) GOSUB ACTIVATE
ON KEY(23) GOSUB PAUSE
ON KEY(24) GOSUB CHEATKEY
GOSUB LIFEMETER: IF METER$ = "ITEM" THEN GOSUB ITEMMETER
MOVE = 0: PX = X: PY = Y: BOOM = 0
IF CASTLE = 0 THEN KEYS = 0
IF CASTLE <> 0 THEN IF STEPS = 2 THEN GOSUB ADVANCEMENT
GOSUB CLOSESHUTTERS
H = 0

DO
KEY(0) ON: FOR CHANCE = 1 TO 1: NEXT CHANCE: KEY(0) STOP
CLOCK = TIMER + .07
MAGMA = MAGMA + FLOW: PALETTE 44, MAGMA: IF MAGMA >= 60 OR MAGMA <= 35 THEN FLOW = -(FLOW): IF MAN <= INT(MAX / 5) THEN IF sound$ <> "MUTE" THEN PLAY "mst255l64o5ff<c"
IF FACE$ = "UP" AND POINT(PX, PY - 1) = 16 THEN KEY(0) OFF: ROOM = ROOM - 100: Y = 17: STEPS = 2: GOTO 1
IF FACE$ = "LEFT" AND POINT(PX - 1, PY) = 16 THEN KEY(0) OFF: ROOM = ROOM - 1: X = 29: STEPS = 2: GOTO 1
IF FACE$ = "RIGHT" AND POINT(PX + 1, PY) = 16 THEN KEY(0) OFF: ROOM = ROOM + 1: X = 6: STEPS = 2: GOTO 1
IF FACE$ = "DOWN" AND POINT(PX, PY + 1) = 16 THEN KEY(0) OFF: ROOM = ROOM + 100: Y = 2: STEPS = 2: GOTO 1
IF MOVE > 0 THEN GOSUB PLACEME
IF MOVE = 0 THEN GOTO 10
PRESET (PX, PY), 0
IF FACE$ = "UP" THEN Y = Y - .2
IF FACE$ = "LEFT" THEN X = X - .2
IF FACE$ = "RIGHT" THEN X = X + .2
IF FACE$ = "DOWN" THEN Y = Y + .2
GOSUB STEPME: GOSUB PLACEME: MOVE = MOVE - 1
IF X > INT(X) + .5 THEN PX = INT(X) + 1 ELSE PX = INT(X)
IF Y > INT(Y) + .5 THEN PY = INT(Y) + 1 ELSE PY = INT(Y)
10 PSET (PX, PY), 1
MONSTERS:

MON1:
A = M1X: B = M1Y: PA = M1PX: PB = M1PY: MONDIR = M1D: MONMOVE = M1M: MPOS = M1P
IF M1L <= 0 THEN GOTO MON2
IF MONMOVE = 0 THEN MONMOVE = 5: RANDOMIZE TIMER: MONDIR = INT(RND * 4) + 1: GOSUB CHECKMP
GOSUB PLACEMON
PRESET (PA, PB), 0
IF MONMOVE = 5 THEN IF MID$(BEHAVIOR$, 1, 1) = "X" THEN GOSUB BEHAVIOR1
IF MONMOVE = 5 THEN IF MID$(BEHAVIOR$, 4, 1) = "X" THEN RANDOMIZE TIMER: IF INT(RND * 20) = 13 THEN GOSUB BEHAVIOR4
PAUSE1 = -(PAUSE1): IF MONMOVE = 5 THEN IF MID$(BEHAVIOR$, 2, 1) = "X" THEN IF PAUSE1 = -1 THEN MONDIR = 0
IF MONDIR = 1 THEN B = B - .2
IF MONDIR = 2 THEN A = A - .2
IF MONDIR = 3 THEN A = A + .2
IF MONDIR = 4 THEN B = B + .2
19 GOSUB STEPMON: GOSUB PLACEMON: MONMOVE = MONMOVE - 1
IF A > INT(A) + .5 THEN PA = INT(A) + 1 ELSE PA = INT(A)
IF B > INT(B) + .5 THEN PB = INT(B) + 1 ELSE PB = INT(B)
M1X = A: M1Y = B: M1PX = PA: M1PY = PB: M1D = MONDIR: M1M = MONMOVE: M1P = MPOS
IF INVINCE = 0 THEN IF PA = PX AND PB = PY THEN PUT (X * 10, Y * 10), XPLODE, XOR: PLAY POW1$: BCLOCK = TIMER + .05: WHILE TIMER < BCLOCK: WEND: MAN = MAN - MATTACK: PUT (X * 10, Y * 10), XPLODE, XOR: GOSUB LIFEMETER: INVINCE = 1: ON TIMER(1) GOSUB  _
VULNERABLE: TIMER ON

20 PSET (PA, PB), 2

MON2:
A = M2X: B = M2Y: PA = M2PX: PB = M2PY: MONDIR = M2D: MONMOVE = M2M: MPOS = M2P
IF M2L <= 0 THEN GOTO MON3
IF MONMOVE = 0 THEN MONMOVE = 5: RANDOMIZE TIMER: MONDIR = INT(RND * 4) + 1: GOSUB CHECKMP
GOSUB PLACEMON
PRESET (PA, PB), 0
IF MONMOVE = 5 THEN IF MID$(BEHAVIOR$, 1, 1) = "X" THEN GOSUB BEHAVIOR1
IF MONMOVE = 5 THEN IF MID$(BEHAVIOR$, 4, 1) = "X" THEN RANDOMIZE TIMER: IF INT(RND * 20) = 13 THEN GOSUB BEHAVIOR4
PAUSE2 = -(PAUSE2): IF MONMOVE = 5 THEN IF MID$(BEHAVIOR$, 2, 1) = "X" THEN IF PAUSE2 = -1 THEN MONDIR = 0
IF MONDIR = 1 THEN B = B - .2
IF MONDIR = 2 THEN A = A - .2
IF MONDIR = 3 THEN A = A + .2
IF MONDIR = 4 THEN B = B + .2
GOSUB STEPMON: GOSUB PLACEMON: MONMOVE = MONMOVE - 1
IF A > INT(A) + .5 THEN PA = INT(A) + 1 ELSE PA = INT(A)
IF B > INT(B) + .5 THEN PB = INT(B) + 1 ELSE PB = INT(B)
M2X = A: M2Y = B: M2PX = PA: M2PY = PB: M2D = MONDIR: M2M = MONMOVE: M2P = MPOS
IF INVINCE = 0 THEN IF PA = PX AND PB = PY THEN PUT (X * 10, Y * 10), XPLODE, XOR: PLAY POW1$: BCLOCK = TIMER + .05: WHILE TIMER < BCLOCK: WEND: MAN = MAN - MATTACK: PUT (X * 10, Y * 10), XPLODE, XOR: GOSUB LIFEMETER: INVINCE = 1: ON TIMER(1) GOSUB  _
VULNERABLE: TIMER ON
30 PSET (PA, PB), 2

MON3:
A = M3X: B = M3Y: PA = M3PX: PB = M3PY: MONDIR = M3D: MONMOVE = M3M: MPOS = M3P
IF M3L <= 0 THEN GOTO SHOOT2
IF MONMOVE = 0 THEN MONMOVE = 5: RANDOMIZE TIMER: MONDIR = INT(RND * 4) + 1: GOSUB CHECKMP
GOSUB PLACEMON
PRESET (PA, PB), 0
IF MONMOVE = 5 THEN IF MID$(BEHAVIOR$, 1, 1) = "X" THEN GOSUB BEHAVIOR1
IF MONMOVE = 5 THEN IF MID$(BEHAVIOR$, 4, 1) = "X" THEN RANDOMIZE TIMER: IF INT(RND * 20) = 13 THEN GOSUB BEHAVIOR4
PAUSE3 = -(PAUSE3): IF MONMOVE = 5 THEN IF MID$(BEHAVIOR$, 2, 1) = "X" THEN IF PAUSE3 = -1 THEN MONDIR = 0
IF MONDIR = 1 THEN B = B - .2
IF MONDIR = 2 THEN A = A - .2
IF MONDIR = 3 THEN A = A + .2
IF MONDIR = 4 THEN B = B + .2
GOSUB STEPMON: GOSUB PLACEMON: MONMOVE = MONMOVE - 1
IF A > INT(A) + .5 THEN PA = INT(A) + 1 ELSE PA = INT(A)
IF B > INT(B) + .5 THEN PB = INT(B) + 1 ELSE PB = INT(B)
M3X = A: M3Y = B: M3PX = PA: M3PY = PB: M3D = MONDIR: M3M = MONMOVE: M3P = MPOS
IF INVINCE = 0 THEN IF PA = PX AND PB = PY THEN PUT (X * 10, Y * 10), XPLODE, XOR: PLAY POW1$: BCLOCK = TIMER + .05: WHILE TIMER < BCLOCK: WEND: MAN = MAN - MATTACK: PUT (X * 10, Y * 10), XPLODE, XOR: GOSUB LIFEMETER: INVINCE = 1: ON TIMER(1) GOSUB  _
VULNERABLE: TIMER ON
40 PSET (PA, PB), 2

SHOOT2:
RANDOMIZE TIMER: IF MID$(BEHAVIOR$, 3, 1) <> "X" OR SHOT <> 0 OR INT(RND * 4) <> 3 THEN GOTO MISSILE1
FOR ROUND = 1 TO 3
IF ROUND = 1 THEN A = M1X: B = M1Y: PA = M1PX: PB = M1PY: MLIFE = M1L: MONMOVE = M1M
IF ROUND = 2 THEN A = M2X: B = M2Y: PA = M2PX: PB = M2PY: MLIFE = M2L: MONMOVE = M2M
IF ROUND = 3 THEN A = M3X: B = M3Y: PA = M3PX: PB = M3PY: MLIFE = M3L: MONMOVE = M3M
IF MONMOVE <> 0 THEN GOTO 41
IF MLIFE > 0 AND PA = PX THEN IF PB > PY THEN SDIR = 1: GOSUB BOOM2
IF MLIFE > 0 AND PB = PY THEN IF PA > PX THEN SDIR = 2: GOSUB BOOM2
IF MLIFE > 0 AND PB = PY THEN IF PA < PX THEN SDIR = 3: GOSUB BOOM2
IF MLIFE > 0 AND PA = PX THEN IF PB < PY THEN SDIR = 4: GOSUB BOOM2
41
NEXT ROUND

MISSILE1:
IF BOOM = 0 THEN GOTO MISSILE2
IF BPOS = 1 THEN PUT (BX * 10, BY * 10), BOOM1, XOR ELSE PUT (BX * 10, BY * 10), BOOM2, XOR: boomif$ = "on"
IF BDIR = 1 THEN BY = BY - .5: IF BY <= 0 THEN BOOM = 0: GOTO MISSILE2
IF BDIR = 2 THEN BX = BX - .5: IF BX <= 0 THEN BOOM = 0: GOTO MISSILE2
IF BDIR = 3 THEN BX = BX + .5: IF BX >= 31 THEN BOOM = 0: GOTO MISSILE2
IF BDIR = 4 THEN BY = BY + .5: IF BY >= 19 THEN BOOM = 0: GOTO MISSILE2
BOOM = BOOM - 1: IF BPOS = 1 THEN BPOS = 2 ELSE BPOS = 1
IF BPOS = 1 THEN PUT (BX * 10, BY * 10), BOOM1, XOR ELSE PUT (BX * 10, BY * 10), BOOM2, XOR
IF BX > INT(BX) + .5 THEN BPX = INT(BX) + 1 ELSE BPX = INT(BX)
IF BY > INT(BY) + .5 THEN BPY = INT(BY) + 1 ELSE BPY = INT(BY)
FOR FIGHT2 = 1 TO 3
IF FIGHT2 = 1 THEN A = M1X: B = M1Y: PA = M1PX: PB = M1PY: MLIFE = M1L: MPOS = M1P
IF FIGHT2 = 2 THEN A = M2X: B = M2Y: PA = M2PX: PB = M2PY: MLIFE = M2L: MPOS = M2P
IF FIGHT2 = 3 THEN A = M3X: B = M3Y: PA = M3PX: PB = M3PY: MLIFE = M3L: MPOS = M3P
IF MLIFE <= 0 GOTO 50
POW = 0

IF BPX = PA AND BPY = PB THEN BOOM = 0: GOSUB PLACEMON: PUT (A * 10, B * 10), XPLODE, XOR: PLAY POW1$: BCLOCK = TIMER + .05: WHILE TIMER < BCLOCK: WEND: MLIFE = MLIFE - BOOMERANG: PUT (A * 10, B * 10), XPLODE, XOR: GOSUB PLACEMON: IF MLIFE <= 0 THEN _
 GOSUB PLACEMON: PLAY POW2$: PSET (PA, PB), 0: GOSUB REWARD: POW = 1: IF MLIFE <= 0 THEN MLIFE = 0
IF FIGHT2 = 1 THEN M1X = A: M1Y = B: M1PX = PA: M1PY = PB: M1L = MLIFE: M1P = MPOS
IF FIGHT2 = 2 THEN M2X = A: M2Y = B: M2PX = PA: M2PY = PB: M2L = MLIFE: M2P = MPOS
IF FIGHT2 = 3 THEN M3X = A: M3Y = B: M3PX = PA: M3PY = PB: M3L = MLIFE: M3P = MPOS
50
NEXT FIGHT2
IF POW = 1 THEN IF M1L = 0 AND M2L = 0 AND M3L = 0 THEN GOSUB OPENSHUTTERS
POW = 0
IF BOOM = 0 AND BPOS = 1 THEN PUT (BX * 10, BY * 10), BOOM1, XOR: boomif$ = "on"
IF BOOM = 0 AND BPOS = 2 THEN PUT (BX * 10, BY * 10), BOOM2, XOR: boomif$ = "on"

MISSILE2:
IF SHOT = 0 THEN GOTO ENDLOOP
PUT (SX * 10, SY * 10), SHOT, XOR
IF SDIR = 1 THEN SY = SY - .5: IF SY <= 0 THEN SHOT = 0: GOTO ENDLOOP
IF SDIR = 2 THEN SX = SX - .5: IF SX <= 0 THEN SHOT = 0: GOTO ENDLOOP
IF SDIR = 3 THEN SX = SX + .5: IF SX >= 31 THEN SHOT = 0: GOTO ENDLOOP
IF SDIR = 4 THEN SY = SY + .5: IF SY >= 19 THEN SHOT = 0: GOTO ENDLOOP
SHOT = SHOT - 1: PUT (SX * 10, SY * 10), SHOT, XOR
IF SX > INT(SX) + .5 THEN SPX = INT(SX) + 1 ELSE SPX = INT(SX)
IF SY > INT(SY) + .5 THEN SPY = INT(SY) + 1 ELSE SPY = INT(SY)
IF SPX = PX AND SPY = PY THEN SHOT = 0: PUT (X * 10, Y * 10), XPLODE, XOR: PLAY POW1$: BCLOCK = TIMER + .05: WHILE TIMER < BCLOCK: WEND: MAN = MAN - MATTACK: PUT (X * 10, Y * 10), XPLODE, XOR: GOSUB LIFEMETER
IF SHOT = 0 THEN PUT (SX * 10, SY * 10), SHOT, XOR

ENDLOOP:
WHILE TIMER < CLOCK: WEND
IF CASTLE = 4 AND ROOM = 203 THEN RANDOMIZE TIMER: RH = INT(RND * 24) + 6: RV = INT(RND * 16) + 2: IF POINT(RH, RV) = 0 THEN PSET (RH, RV), 7: PUT (RH * 10, RV * 10), ROCK, XOR: PLAY SPLUT$
IF CASTLE = 9 AND ROOM = 306 THEN RANDOMIZE TIMER: RH = INT(RND * 24) + 6: RV = INT(RND * 16) + 2: IF POINT(RH, RV) = 0 THEN PSET (RH, RV), 7: PUT (RH * 10, RV * 10), ROCK, XOR: PLAY SPLUT$
LOOP UNTIL INKEY$ = ""
CHAIN "SAVE.BAS"



UPME:                                           'I MOVE UP.
IF MOVE <> 0 THEN RETURN
IF FACE$ <> "UP" THEN GOSUB PLACEME: FACE$ = "UP": GOSUB PLACEME: RETURN
IF POINT(PX, PY - 1) = 2 OR POINT(PX, PY - 1) = 3 OR POINT(PX, PY - 1) = 7 THEN RETURN
IF POINT(PX, PY - 1) <> BACK THEN DX = PX: DY = PY - 1: GOSUB CHECKSQUARE: IF MOVE = -1 THEN MOVE = 0: RETURN
KEY(0) STOP
GOSUB PLACEME
MOVE = 5
GOSUB PLACEME
RETURN
LEFTME:                                         'I MOVE LEFT.
IF MOVE <> 0 THEN RETURN
IF FACE$ <> "LEFT" THEN GOSUB PLACEME: FACE$ = "LEFT": GOSUB PLACEME: RETURN
IF POINT(PX - 1, PY) = 2 OR POINT(PX - 1, PY) = 3 OR POINT(PX - 1, PY) = 7 THEN RETURN
IF POINT(PX - 1, PY) <> BACK THEN DX = PX - 1: DY = PY: GOSUB CHECKSQUARE: IF MOVE = -1 THEN MOVE = 0: RETURN
KEY(0) STOP
GOSUB PLACEME
MOVE = 5
GOSUB PLACEME
RETURN
RIGHTME:                                        'I MOVE RIGHT.
IF MOVE <> 0 THEN RETURN
IF FACE$ <> "RIGHT" THEN GOSUB PLACEME: FACE$ = "RIGHT": GOSUB PLACEME: RETURN
IF POINT(PX + 1, PY) = 2 OR POINT(PX + 1, PY) = 3 OR POINT(PX + 1, PY) = 7 THEN RETURN
IF POINT(PX + 1, PY) <> BACK THEN DX = PX + 1: DY = PY: GOSUB CHECKSQUARE: IF MOVE = -1 THEN MOVE = 0: RETURN
KEY(0) STOP
GOSUB PLACEME
MOVE = 5
GOSUB PLACEME
RETURN
DOWNME:                                         'I MOVE DOWN.
IF MOVE <> 0 THEN RETURN
IF FACE$ <> "DOWN" THEN GOSUB PLACEME: FACE$ = "DOWN": GOSUB PLACEME: RETURN
IF POINT(PX, PY + 1) = 2 OR POINT(PX, PY + 1) = 3 OR POINT(PX, PY + 1) = 7 THEN RETURN
IF POINT(PX, PY + 1) <> BACK THEN DX = PX: DY = PY + 1: GOSUB CHECKSQUARE: IF MOVE = -1 THEN MOVE = 0: RETURN
KEY(0) STOP
GOSUB PLACEME
MOVE = 5
GOSUB PLACEME
RETURN

STEPME:                                         'I STEP.
IF STEPS = 1 THEN STEPS = 2: RETURN
IF STEPS = 2 THEN STEPS = 1: RETURN
PLACEME:                                        'PLACE MY IMAGE.
IF FACE$ = "UP" AND STEPS = 1 THEN PUT (X * 10, Y * 10), MAN1U, XOR
IF FACE$ = "UP" AND STEPS = 2 THEN PUT (X * 10, Y * 10), MAN2U, XOR
IF FACE$ = "LEFT" AND STEPS = 1 THEN PUT (X * 10, Y * 10), MAN1L, XOR
IF FACE$ = "LEFT" AND STEPS = 2 THEN PUT (X * 10, Y * 10), MAN2L, XOR
IF FACE$ = "RIGHT" AND STEPS = 1 THEN PUT (X * 10, Y * 10), MAN1R, XOR
IF FACE$ = "RIGHT" AND STEPS = 2 THEN PUT (X * 10, Y * 10), MAN2R, XOR
IF FACE$ = "DOWN" AND STEPS = 1 THEN PUT (X * 10, Y * 10), MAN1D, XOR
IF FACE$ = "DOWN" AND STEPS = 2 THEN PUT (X * 10, Y * 10), MAN2D, XOR
RETURN

STEPMON:                                        'MONSTER STEPS.
STEPMON2:
IF MPOS = 1 THEN MPOS = 2: RETURN
IF MPOS = 2 THEN MPOS = 1: RETURN
PLACEMON:                                       'PLACE MONSTER'S IMAGE.
IF MPOS = 1 THEN PUT (A * 10, B * 10), MONSTER1, XOR
IF MPOS = 2 THEN PUT (A * 10, B * 10), MONSTER2, XOR
RETURN

CHECKMP:
IF MONDIR = 1 THEN IF POINT(PA, PB - 1) < 2 THEN RETURN
IF MONDIR = 2 THEN IF POINT(PA - 1, PB) < 2 THEN RETURN
IF MONDIR = 3 THEN IF POINT(PA + 1, PB) < 2 THEN RETURN
IF MONDIR = 4 THEN IF POINT(PA, PB + 1) < 2 THEN RETURN
MONDIR = 0: RETURN

BEHAVIOR1:
RANDOMIZE TIMER: BEHAVE = INT(RND * 2) + 1
IF BEHAVE = 1 AND B > Y THEN MONDIR = 1
IF BEHAVE = 2 AND A > X THEN MONDIR = 2
IF BEHAVE = 2 AND A < X THEN MONDIR = 3
IF BEHAVE = 1 AND B < Y THEN MONDIR = 4
GOSUB CHECKMP: RETURN

BEHAVIOR4:
RANDOMIZE TIMER
PUT (A * 10, B * 10), TELE, XOR
PSET (PA, PB), 0: IF PA = PX AND PB = PY THEN PSET (PX, PY), 1
GOTO RETRY
RETRY2: PA = INT(RND * 20) + 9: PB = INT(RND * 14) + 3: IF POINT(PA, PB) = 0 AND POINT(PA + 1, PB) = 0 THEN PSET (PA, PB), 2: GOTO RIGHTON ELSE GOTO RETRY2
RETRY: PA = INT(RND * 20) + 9: PB = INT(RND * 14) + 3: IF POINT(PA, PB) = 0 THEN PSET (PA, PB), 2 ELSE GOTO RETRY
RIGHTON:
PUT (PA * 10, PB * 10), TELE, XOR
PLAY WARP$
PUT (A * 10, B * 10), TELE, XOR
A = PA: B = PB
PUT (A * 10, B * 10), TELE, XOR
GOSUB CHECKMP: RETURN

BOOM:
IF boomif$ = "on" THEN IF BOOM <> 0 AND BPOS = 1 THEN PUT (BX * 10, BY * 10), BOOM1, XOR: BOOM = 0
IF boomif$ = "on" THEN IF BOOM <> 0 AND BPOS = 2 THEN PUT (BX * 10, BY * 10), BOOM2, XOR: BOOM = 0
IF boomif$ = "off" AND BOOM = 1 THEN BOOM = 0
boomif$ = "off"
KEY(0) STOP
BX = X: BY = Y
IF FACE$ = "UP" THEN BY = Y - .2: BDIR = 1
IF FACE$ = "LEFT" THEN BX = X - .2: BDIR = 2
IF FACE$ = "RIGHT" THEN BX = X + .2: BDIR = 3
IF FACE$ = "DOWN" THEN BY = Y + .2: BDIR = 4
BOOM = 9: BPOS = 1
PUT (BX * 10, BY * 10), BOOM1, XOR
boomif$ = "on"
PLAY BOOM$
RETURN

BOOM2:
IF SHOT <> 0 THEN RETURN
KEY(0) STOP
SX = A: SY = B
IF SDIR = 1 THEN SY = B - .2
IF SDIR = 2 THEN SX = A - .2
IF SDIR = 3 THEN SX = A + .2
IF SDIR = 4 THEN SY = B + .2
SHOT = 9
PUT (SX * 10, SY * 10), SHOT, XOR
PLAY BOOM$
RETURN

VULNERABLE:
TIMER OFF
INVINCE = 0: RETURN

ACTIVATE:
IF MOVE <> 0 THEN RETURN
KEY(0) OFF
IF ITEM = 1 AND MID$(ITEM$, 1, 1) = "X" THEN GOTO USEHAMMER
IF ITEM = 2 AND MID$(ITEM$, 2, 1) = "X" THEN GOTO USERECORDER
IF ITEM = 3 AND MID$(ITEM$, 3, 1) = "X" THEN GOTO USEELIXER
RETURN

SWITCHMETER:
IF METER$ = "LIFE" THEN METER$ = "ITEM": GOSUB ITEMMETER: RETURN
IF METER$ = "ITEM" THEN METER$ = "LIFE": GOSUB LIFEMETER: RETURN

SWITCH:
IF METER$ = "LIFE" THEN RETURN
SW1: IF ITEM = 1 THEN PUT (5, 80), SELECTOR, XOR: ITEM = 2: GOTO SW4
SW2: IF ITEM = 2 THEN PUT (5, 100), SELECTOR, XOR: ITEM = 3: GOTO SW4
SW3: IF ITEM = 3 THEN PUT (5, 120), SELECTOR, XOR: ITEM = 1: GOTO SW4
SW4:
IF ITEM = 1 THEN PUT (5, 80), SELECTOR, XOR
IF ITEM = 2 THEN PUT (5, 100), SELECTOR, XOR
IF ITEM = 3 THEN PUT (5, 120), SELECTOR, XOR
RETURN

ITEMMETER:
IF METER$ = "LIFE" THEN RETURN
LINE (0, 65)-(30, 199), 0, BF
DRAW "BM11,68C10NLNRD4NLRBR3U4NLRBR2NR2D2NR2D2R2BR2U4F2E2D4"
IF MID$(ITEM$, 1, 1) = "X" THEN DRAW "BM14,80BDC26DFC25U3RC23D3UE2F2DU3RC25D3EC26UBM-3,-1C115GNHFGNHFGNHFGNHFDL2URC116EHNGEHNGEHNG"
IF MID$(ITEM$, 2, 1) = "X" THEN DRAW "BM14,100BR2C43R5GL3F2LDFLDFLDC42RDBU3D0BU2D0BU2D0"
IF MID$(ITEM$, 3, 1) = "X" THEN DRAW "BM14,120BR3C115R3DL3FRBM-3,-1C15FD3G2DFR5EUH2U3EBG2C53LFDLDLGFRUREFDL2C52EHBM-3,+2EBM+1,-3D0"
IF ITEM = 1 THEN PUT (5, 80), SELECTOR, XOR
IF ITEM = 2 THEN PUT (5, 100), SELECTOR, XOR
IF ITEM = 3 THEN PUT (5, 120), SELECTOR, XOR
IF MONEY > 99 THEN MONEY = 99
DRAW "BM9,148C43U4F2E2D4BR3HU2EFD2BDBR2U4F3DU4BR2NR2D2NR2D2R2BU4BR2DFND2EU"
COLOR 15
IF MONEY < 10 THEN LOCATE 20, 2: PRINT MONEY
IF MONEY >= 10 THEN LOCATE 20, 1: PRINT MONEY
IF KEYS > 9 THEN KEYS = 9
DRAW "BM11,168C14D2NE2ND2F2BR2NR2U2NR2U2R2BR2DFND2EUBR3NR2GFRFGL2"
LOCATE 23, 2: PRINT KEYS
RETURN

LIFEMETER:
IF MAN > MAX THEN MAN = MAX
IF MAN <= 0 THEN MAN = 0
IF MAN > 0 AND METER$ = "ITEM" THEN RETURN
LINE (0, 65)-(30, 199), 0, BF
DRAW "BM11,68C4D4R2BR2R2LU4NLRBR2NR2D2NR2D2BR4NR2U2NR2U2NR2"
IF MAN <= INT(MAX / 5) THEN DRAW "BM11,68C44D4R2BR2R2LU4NLRBR2NR2D2NR2D2BR4NR2U2NR2U2NR2"
LINE (17, 75)-(19, 75 + (MAX * 2)), 15, BF
LINE (18, 75)-(18, 75 + (MAN * 2)), 4
IF MAN <= 0 THEN LINE (X * 10, Y * 10)-STEP(9, 9), 0, BF: PUT (X * 10, Y * 10), MAN1D, OR: TIME = TIMER + 3: WHILE TIMER < TIME: WEND: CHAIN "LOSE.SEQ"
RETURN



USEHAMMER:
PLAY HAMMERSTRIKE$
IF FACE$ = "UP" THEN IF POINT(PX, PY - 1) = 7 THEN PSET (PX, PY - 1), 0: PUT (PX * 10, (PY - 1) * 10), XPLODE, XOR: PUT (PX * 10, (PY - 1) * 10), ROCK, XOR: PLAY POP$: PUT (PX * 10, (PY - 1) * 10), XPLODE, XOR: H = H + 1
IF FACE$ = "LEFT" THEN IF POINT(PX - 1, PY) = 7 THEN PSET (PX - 1, PY), 0: PUT ((PX - 1) * 10, PY * 10), XPLODE, XOR: PUT ((PX - 1) * 10, PY * 10), ROCK, XOR: PLAY POP$: PUT ((PX - 1) * 10, PY * 10), XPLODE, XOR: H = H + 1
IF FACE$ = "RIGHT" THEN IF POINT(PX + 1, PY) = 7 THEN PSET (PX + 1, PY), 0: PUT ((PX + 1) * 10, PY * 10), XPLODE, XOR: PUT ((PX + 1) * 10, PY * 10), ROCK, XOR: PLAY POP$: PUT ((PX + 1) * 10, PY * 10), XPLODE, XOR: H = H + 1
IF FACE$ = "DOWN" THEN IF POINT(PX, PY + 1) = 7 THEN PSET (PX, PY + 1), 0: PUT (PX * 10, (PY + 1) * 10), XPLODE, XOR: PUT (PX * 10, (PY + 1) * 10), ROCK, XOR: PLAY POP$: PUT (PX * 10, (PY + 1) * 10), XPLODE, XOR: H = H + 1
IF CASTLE = 0 AND ROOM = 615 AND H = 1 THEN H = 0: PSET (21, 9), 6: PUT (210, 90), STAIRCASE, XOR: PLAY SECRET$
IF CASTLE = 0 AND ROOM = 800 AND H = 4 THEN H = 0: GOSUB TREASURECAVE
RETURN

USERECORDER:
PLAY RECORDERMUSIC$
IF MONSTER$ = "SPECTRE" THEN PALETTE 16, 45
IF CASTLE = 5 AND ROOM = 302 THEN PUT (240, 140), TOMB, XOR: PSET (24, 14), 6: PUT (240, 140), STAIRCASE, OR: PLAY SURPRISE$
IF CASTLE = 6 AND ROOM = 603 AND LEFT$(PROGRESS$, 5) = "XXXXX" THEN FOR ZAP = 15 TO 20: GOSUB ALTERNATE: PUT (ZAP * 10, 50), XPLODE, XOR: PUT (ZAP * 10, 50), BLOCK, XOR: PLAY POP$: PUT (ZAP * 10, 50), XPLODE, XOR: NEXT ZAP: GOTO OPUS
IF CASTLE = 0 AND ROOM = 615 THEN PSET (21, 9), 7: PUT (210, 90), TOMB, XOR: PUT (210, 90), ROCK, XOR: PLAY SECRET$
RETURN

OPUS:
RETURN
ALTERNATE:
IF POINT(ZAP, 5) = 0 THEN PSET (ZAP, 5), 3: RETURN
IF POINT(ZAP, 5) = 3 THEN PSET (ZAP, 5), 0: RETURN
RETURN

TREASURECAVE:
PSET (17, 13), 6: PSET (17, 14), 0
PUT (170, 130), BLOCK, XOR: PUT (170, 130), CAVE, OR: PUT (170, 140), BLOCK, XOR
PLAY SECRET$
RETURN

USEELIXER:
MID$(ITEM$, 3, 1) = "O": MAN = MAX
FOR GULP = 1 TO 3: PLAY GULP$: NEXT GULP
METER$ = "ITEM"
GOSUB SWITCHMETER: GOSUB SWITCHMETER: RETURN

REWARD:
RANDOMIZE TIMER
PRIZE = INT(RND * 10) + 1
IF PRIZE <= 2 THEN PSET (PA, PB), 4: PUT (PA * 10, PB * 10), HEART, XOR
IF CASTLE <> 0 THEN IF PRIZE = 6 THEN PSET (PA, PB), 5: PUT (PA * 10, PB * 10), LOCKKEY, XOR
IF PRIZE >= 9 THEN PSET (PA, PB), 8: PUT (PA * 10, PB * 10), COIN, XOR
RETURN

SETBOUNDS:
LINE (36, 0)-(36, 199), 23                      '
LINE (37, 0)-(37, 199), 25
LINE (38, 0)-(39, 199), 27, BF
LINE (40, 0)-(40, 199), 25
LINE (41, 0)-(41, 199), 23
LINE (0, 25)-(36, 25), 23                       '
LINE (0, 26)-(37, 26), 25
LINE (0, 27)-(38, 28), 27, BF
LINE (0, 29)-(37, 29), 25
LINE (0, 30)-(36, 30), 23
LINE (0, 55)-(36, 55), 23                       '
LINE (0, 56)-(37, 56), 25
LINE (0, 57)-(38, 58), 27, BF
LINE (0, 59)-(37, 59), 25
LINE (0, 60)-(36, 60), 23
LINE (36, 0)-(319, 0), 23                       '
LINE (37, 1)-(319, 1), 25
LINE (39, 2)-(319, 3), 27, BF
LINE (40, 4)-(319, 4), 25
LINE (41, 5)-(319, 5), 23
LINE (41, 194)-(319, 194), 23                       '
LINE (40, 195)-(319, 195), 25
LINE (39, 196)-(319, 197), 27, BF
LINE (37, 198)-(319, 198), 25
LINE (36, 199)-(319, 199), 23
LINE (314, 5)-(314, 194), 23                      '
LINE (315, 4)-(315, 195), 25
LINE (316, 2)-(317, 197), 27, BF
LINE (318, 1)-(318, 198), 25
LINE (319, 0)-(319, 199), 23
DISPLAYBOOM:
PUT (14, 42), BOOM1, OR
DISPLAY$ = "BM6,36CxxD4E2F2U4BR2NR2D2NR2D2R2BR2U3EFDNLD2BR2U4RFDNLBU2BR3GD2FEU2BUBR2ND4F3DU4"
MID$(DISPLAY$, 8, 2) = MID$(BOOM2$, 15, 2): DRAW DISPLAY$
RETURN

SCREEN4SCENE:
FILESPEC$ = "CAS1#999.DAT"
MID$(FILESPEC$, 4, 1) = CHR$(CASTLE + 48)
IF CASTLE = 0 THEN MID$(FILESPEC$, 1, 3) = "OUT"
IF CASTLE > 6 THEN MID$(FILESPEC$, 1, 3) = "CAV"
MID$(FILESPEC$, 6, 3) = MID$((STR$(ROOM)), 2, 3)
RETURN

READBITMAP:
LINE (5, 1)-(30, 18), 16, B
LINE (6, 2)-(29, 17), 0, BF
SHUTTER$ = "                    ": SHUTTER = 1
FOR ROW = 6 TO 29
IF EOF(1) = 1 THEN EXIT FOR
FOR COLUMN = 2 TO 17
IF EOF(1) = 1 THEN EXIT FOR
IF EOF(1) = 0 THEN INPUT #1, LOADED
IF LOADED > 0 THEN PSET (ROW, COLUMN), 3
IF LOADED = 1 THEN PUT (ROW * 10, COLUMN * 10), BRICKWALL, OR
IF LOADED = 2 THEN PUT (ROW * 10, COLUMN * 10), BLOCK, OR
IF LOADED = 3 THEN PUT (ROW * 10, COLUMN * 10), PILLAR, OR
IF LOADED = 4 THEN PUT (ROW * 10, COLUMN * 10), STATUE, OR
IF LOADED = 5 THEN PUT (ROW * 10, COLUMN * 10), TOMB, OR
IF LOADED = 6 THEN MID$(SHUTTER$, SHUTTER, 1) = CHR$(ROW): MID$(SHUTTER$, SHUTTER + 1, 1) = CHR$(COLUMN): SHUTTER = SHUTTER + 2: PRESET (ROW, COLUMN), 0
IF LOADED = 7 THEN PUT (ROW * 10, COLUMN * 10), TREE, OR
IF LOADED = 8 AND CASTLE <> 0 THEN PUT (ROW * 10, COLUMN * 10), KEYLOCK, OR: PSET (ROW, COLUMN), 9
IF LOADED = 8 AND CASTLE = 0 THEN PUT (ROW * 10, COLUMN * 10), DOOR, OR: PSET (ROW, COLUMN), 9
IF LOADED = 9 THEN PUT (ROW * 10, COLUMN * 10), ROCK, OR: PSET (ROW, COLUMN), 7
IF LOADED = 10 THEN PUT (ROW * 10, COLUMN * 10), DOOR, OR: PSET (ROW, COLUMN), 6
IF LOADED = 11 THEN PUT (ROW * 10, COLUMN * 10), STAIRCASE, OR: PSET (ROW, COLUMN), 6
IF LOADED = 12 THEN PUT (ROW * 10, COLUMN * 10), GRASS, OR: PSET (ROW, COLUMN), 0
IF LOADED = 13 THEN PUT (ROW * 10, COLUMN * 10), LADDER, OR: PSET (ROW, COLUMN), 0
IF LOADED = 14 AND CASTLE < 7 THEN PUT (ROW * 10, COLUMN * 10), CAVE, OR: PSET (ROW, COLUMN), 6
IF LOADED = 14 AND CASTLE >= 7 THEN PUT (ROW * 10, COLUMN * 10), INCAVE, OR: PSET (ROW, COLUMN), 6
IF LOADED = 15 AND CASTLE = 0 THEN PUT (ROW * 10, COLUMN * 10), SIGN, OR: PSET (ROW, COLUMN), 10
IF LOADED = 15 AND CASTLE > 0 THEN PUT (ROW * 10, COLUMN * 10), MONUMENT, OR: PSET (ROW, COLUMN), 10
IF LOADED = 16 THEN PUT (ROW * 10, COLUMN * 10), MOUNT, OR
IF LOADED = 17 THEN PUT (ROW * 10, COLUMN * 10), MOUNTL, OR
IF LOADED = 18 THEN PUT (ROW * 10, COLUMN * 10), MOUNTR, OR
IF LOADED = 19 THEN PUT (ROW * 10, COLUMN * 10), MOUNTT, OR
IF LOADED = 20 THEN PUT (ROW * 10, COLUMN * 10), CHEST, OR: PSET (ROW, COLUMN), 11
IF LOADED = 21 THEN PUT (ROW * 10, COLUMN * 10), SHRUB, OR
IF LOADED = 22 THEN PUT (ROW * 10, COLUMN * 10), WATER, OR
IF LOADED = 23 THEN PUT (ROW * 10, COLUMN * 10), LAVA, OR
IF LOADED = 24 THEN PUT (ROW * 10, COLUMN * 10), HEART, OR: PSET (ROW, COLUMN), 4
IF LOADED = 25 THEN PUT (ROW * 10, COLUMN * 10), LOCKKEY, OR: PSET (ROW, COLUMN), 5
IF LOADED = 26 THEN PUT (ROW * 10, COLUMN * 10), COIN, OR: PSET (ROW, COLUMN), 8
IF LOADED = 27 THEN PSET (ROW, COLUMN), 17
IF LOADED = 28 THEN PUT (ROW * 10, COLUMN * 10), BRICKWALL, OR: PRESET (ROW, COLUMN), 0
IF LOADED = 29 THEN PUT (ROW * 10, COLUMN * 10), MAN, OR: PSET (ROW, COLUMN), 12
IF LOADED = 30 THEN PUT (ROW * 10, COLUMN * 10), LADY, OR: PSET (ROW, COLUMN), 13
IF LOADED = 31 THEN PUT (ROW * 10, COLUMN * 10), GEEZER, OR: PSET (ROW, COLUMN), 14
IF LOADED = 32 THEN PUT (ROW * 10, COLUMN * 10), MERCHANT, OR: PSET (ROW, COLUMN), 15
IF LOADED = 33 THEN PUT (ROW * 10, COLUMN * 10), CAVEWALL, OR
IF LOADED = 34 THEN PUT (ROW * 10, COLUMN * 10), BEACHUL, OR
IF LOADED = 35 THEN PUT (ROW * 10, COLUMN * 10), BEACHUR, OR
IF LOADED = 36 THEN PUT (ROW * 10, COLUMN * 10), BEACHDL, OR
IF LOADED = 37 THEN PUT (ROW * 10, COLUMN * 10), BEACHDR, OR
IF LOADED = 38 THEN PUT (ROW * 10, COLUMN * 10), KID, OR: PSET (ROW, COLUMN), 18
IF LOADED = 39 THEN PUT (ROW * 10, COLUMN * 10), GOLDBRICK, OR
IF LOADED = 40 THEN PUT (ROW * 10, COLUMN * 10), GOLDPILLAR, OR
IF LOADED = 41 THEN PUT (ROW * 10, COLUMN * 10), GOLDSTATUE, OR
IF LOADED = 42 THEN PUT (ROW * 10, COLUMN * 10), GOLDBLOCK, OR
IF LOADED = 43 THEN PUT (ROW * 10, COLUMN * 10), GOLDDOOR, OR: PSET (ROW, COLUMN), 6

NEXT COLUMN
NEXT ROW
CLOSE #1
IF CASTLE = 3 AND ROOM = 207 AND BOOMERANG = 1 THEN PSET (20, 6), 15: PUT (200, 60), MERCHANT, OR: PSET (24, 6), 11: PUT (240, 60), CHEST, OR
IF CASTLE = 7 AND ROOM = 100 AND MID$(ITEM$, 1, 1) = "O" THEN PSET (15, 5), 11: PUT (150, 50), CHEST, OR: PSET (25, 4), 15: PUT (250, 40), MERCHANT, OR
IF CASTLE = 8 AND ROOM = 302 AND MID$(ITEM$, 3, 1) = "O" THEN PSET (18, 15), 11: PUT (180, 150), CHEST, OR: PSET (13, 13), 14: PUT (130, 130), GEEZER, OR
IF CASTLE = 9 AND ROOM = 100 AND MID$(PROGRESS$, 6, 1) = "O" THEN PSET (16, 6), 11: PUT (160, 60), CHEST, OR
IF CASTLE = 9 AND ROOM = 401 AND MID$(PROGRESS$, 7, 1) = "O" THEN PSET (24, 14), 11: PUT (240, 140), CHEST, OR
IF CASTLE = 9 AND ROOM = 104 AND MID$(PROGRESS$, 8, 1) = "O" THEN PSET (16, 5), 11: PUT (160, 50), CHEST, OR
RETURN

CHECKSQUARE:
IF POINT(DX, DY) = 17 THEN MOVE = -1: RETURN
IF POINT(DX, DY) = 4 THEN PSET (DX, DY), BACK: PUT (DX * 10, DY * 10), HEART, XOR: PLAY GETHEART$: MAN = MAN + 5: GOSUB LIFEMETER: RETURN
IF POINT(DX, DY) = 5 THEN PSET (DX, DY), BACK: PUT (DX * 10, DY * 10), LOCKKEY, XOR: PLAY GETKEY$: KEYS = KEYS + 1: GOSUB ITEMMETER: RETURN
IF POINT(DX, DY) = 6 THEN GOTO CHECKEXIT
IF POINT(DX, DY) = 8 THEN PSET (DX, DY), BACK: PUT (DX * 10, DY * 10), COIN, XOR: PLAY GETKEY$: MONEY = MONEY + 1: GOSUB ITEMMETER: RETURN
IF POINT(DX, DY) = 9 THEN IF CASTLE = 0 THEN LINE1$ = "This door is locked.": LINE2$ = "Some people lock their": LINE3$ = "doors when there are": LINE4$ = "monsters running about.": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 9 THEN IF KEYS <= 0 THEN MOVE = -1: RETURN
IF POINT(DX, DY) = 9 THEN IF KEYS > 0 THEN PSET (DX, DY), BACK: PUT (DX * 10, DY * 10), KEYLOCK, XOR: PLAY OPENLOCK$: KEYS = KEYS - 1: GOSUB ITEMMETER: RETURN
IF POINT(DX, DY) = 11 THEN IF CASTLE = 3 AND ROOM = 207 THEN PSET (DX, DY), BACK: PUT (DX * 10, DY * 10), CHEST, XOR: PLAY getchest$: BOOMERANG = 2: GOSUB DISPLAYBOOM: PSET (20, 6), BACK: PUT (200, 60), MERCHANT, XOR: RETURN
IF POINT(DX, DY) = 11 THEN IF CASTLE = 5 AND ROOM = 305 THEN PSET (DX, DY), BACK: PUT (DX * 10, DY * 10), CHEST, XOR: PLAY getchest$: BOOMERANG = 4: GOSUB DISPLAYBOOM: RETURN
IF POINT(DX, DY) = 11 THEN IF CASTLE = 5 AND ROOM = 404 THEN PSET (DX, DY), BACK: PUT (DX * 10, DY * 10), CHEST, XOR: PLAY getchest$: PUT (DX * 10, DY * 10), XPLODE, XOR: PLAY POW2$: PLAY SPLUT$: PLAY SPLUT$: PLAY SPLUT$: PLAY SPLUT$: PLAY SPLUT$: _
    PLAY SPLUT$: PLAY SPLUT$: PLAY SPLUT$: PLAY SPLUT$: MAN = 0: GOSUB LIFEMETER: PUT (DX * 10, DY * 10), XPLODE, XOR
IF POINT(DX, DY) = 11 THEN IF CASTLE = 7 AND ROOM = 100 THEN PSET (DX, DY), BACK: PUT (DX * 10, DY * 10), CHEST, XOR: PLAY getchest$: LINE1$ = "": LINE2$ = "You've got the hammer!": LINE3$ = "": LINE4$ = "": MID$(ITEM$, 1, 1) = "X": GOSUB WINDOWS: _
    PRESET (25, 4), 0: PUT (250, 40), MERCHANT, XOR: RETURN
IF POINT(DX, DY) = 11 THEN IF CASTLE = 8 AND ROOM = 302 THEN PSET (DX, DY), BACK: PUT (DX * 10, DY * 10), CHEST, XOR: PLAY getchest$: LINE1$ = "": LINE2$ = "You've got the": LINE3$ = "recorder!": LINE4$ = "": MID$(ITEM$, 2, 1) = "X": GOSUB WINDOWS: _
     PRESET (13, 13), 0: PUT (130, 130), GEEZER, XOR: RETURN
IF POINT(DX, DY) = 11 THEN IF CASTLE = 9 AND ROOM = 100 THEN PSET (DX, DY), BACK: PUT (DX * 10, DY * 10), CHEST, XOR: PLAY getchest$: LINE1$ = "You've found": LINE2$ = "Rupert's treasure!": LINE3$ = "": LINE4$ = "Total value: $25": MONEY = MONEY +  _
25: MID$(PROGRESS$, 6, 1) = "X": GOSUB WINDOWS: GOSUB ITEMMETER: RETURN
IF POINT(DX, DY) = 11 THEN IF CASTLE = 9 AND ROOM = 401 THEN PSET (DX, DY), BACK: PUT (DX * 10, DY * 10), CHEST, XOR: PLAY getchest$: LINE1$ = "You've found": LINE2$ = "Gomer's treasure!": LINE3$ = "": LINE4$ = "Total value: $50": MONEY = MONEY + 50 _
: MID$(PROGRESS$, 7, 1) = "X": GOSUB WINDOWS: GOSUB ITEMMETER: RETURN
IF POINT(DX, DY) = 11 THEN IF CASTLE = 9 AND ROOM = 104 THEN PSET (DX, DY), BACK: PUT (DX * 10, DY * 10), CHEST, XOR: PLAY getchest$: LINE1$ = "You've found": LINE2$ = "Vartra's treasure!": LINE3$ = "": LINE4$ = "Total value: $99": MONEY = MONEY +  _
99: MID$(PROGRESS$, 8, 1) = "X": GOSUB WINDOWS: GOSUB ITEMMETER: RETURN
IF POINT(DX, DY) = 10 THEN IF CASTLE = 0 AND ROOM = 305 THEN LINE1$ = "  MARUBIA INN": LINE2$ = "  CASTLE #1": LINE3$ = "  TOWN OF MARUBIA": LINE4$ = "  OGRES' CAVE": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 10 THEN IF CASTLE = 0 AND ROOM = 401 THEN LINE1$ = "  ELIXER SHOP": LINE2$ = "  KUPUGARO MOUNTAINS": LINE3$ = "  GOMER'S BRIDGE": LINE4$ = "  CASTLE #1": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 10 THEN IF CASTLE = 0 AND ROOM = 201 THEN LINE1$ = "  VILLAGE OF TINGAL": LINE2$ = "  RUPERT'S CAVE": LINE3$ = "  EDUMO FOREST": LINE4$ = "": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 10 THEN IF CASTLE = 0 AND ROOM = 500 THEN LINE1$ = "": LINE2$ = "  Ye Olde": LINE3$ = "    Elixer Shoppe ": LINE4$ = "": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 10 THEN IF CASTLE = 0 AND ROOM = 702 THEN LINE1$ = "  GOMER'S BRIDGE": LINE2$ = "  VARTRA'S GROVE": LINE3$ = "  HAUNTED CEMETARY": LINE4$ = "  ELIXER SHOP": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 10 THEN IF CASTLE = 0 AND ROOM = 708 THEN LINE1$ = "  CITY OF SALUM": LINE2$ = "  LAKE JYDA": LINE3$ = "  HAUNTED CEMETARY": LINE4$ = "  CASTLE #5": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 10 THEN IF CASTLE = 0 AND ROOM = 106 THEN LINE1$ = "": LINE2$ = "   *TERESA'S GROVE*": LINE3$ = " (Don't ask, people!)": LINE4$ = "": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 10 THEN IF CASTLE = 0 AND ROOM = 110 THEN LINE1$ = "": LINE2$ = "  CASTLE #3": LINE3$ = "  KENEYLON FOREST": LINE4$ = "": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 10 THEN IF CASTLE = 0 AND ROOM = 214 THEN LINE1$ = "FOR SALE: one magical": LINE2$ = "recorder: ancient, but": LINE3$ = "in good condition;": LINE4$ = "asking 40$. -the Hermit": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 10 THEN IF CASTLE = 0 AND ROOM = 513 THEN LINE1$ = "  TOWN OF GORM": LINE2$ = "  CASTLE #2": LINE3$ = "  VARTRA'S GRAVE": LINE4$ = "  LAKE JYDA": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 10 THEN IF CASTLE = 0 AND ROOM = 115 THEN LINE1$ = "": LINE2$ = "This is a dead end. ": LINE3$ = "": LINE4$ = "": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 10 THEN IF CASTLE = 0 AND ROOM = 415 THEN LINE1$ = "": LINE2$ = "      *WELCME*": LINE3$ = "  VILAGEF WENDEL   ": LINE4$ = "": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 10 THEN IF CASTLE = 0 AND ROOM = 706 THEN LINE1$ = "": LINE2$ = "  CASTLE #4": LINE3$ = "": LINE4$ = "": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 10 THEN IF CASTLE = 1 AND ROOM = 200 THEN LINE1$ = "Each castle is ": LINE2$ = "controlled by a strong": LINE3$ = "boss monster. You must": LINE4$ = "find and destroy it!": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 10 THEN IF CASTLE = 1 AND ROOM = 102 THEN LINE1$ = "Find keys by defeating": LINE2$ = "monsters. Use them to": LINE3$ = "open locks in castles": LINE4$ = "they are found in.": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 10 THEN IF CASTLE = 2 AND ROOM = 600 THEN LINE1$ = "Use the hammer to smash": LINE2$ = "boulders. Find it in": LINE3$ = "the ogres' cave.": LINE4$ = "Go North-west.": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 10 THEN IF CASTLE = 3 AND ROOM = 306 THEN LINE1$ = "There is a stronger": LINE2$ = "weapon hidden inside": LINE3$ = "this castle. Find it": LINE4$ = "before you leave.": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 10 THEN IF CASTLE = 5 AND ROOM = 404 THEN LINE1$ = "Do not touch the": LINE2$ = "mummy's accursed": LINE3$ = "treasures. Leave them": LINE4$ = "alone!!!": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 10 THEN IF CASTLE = 6 AND ROOM = 200 THEN LINE1$ = "There are hearts behind": LINE2$ = "a false wall. X marks": LINE3$ = "the spot.": LINE4$ = "          Good Luck!!!": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 10 THEN IF CASTLE = 6 AND ROOM = 402 THEN LINE1$ = "": LINE2$ = "Proceed through the": LINE3$ = "dead end.": LINE4$ = "": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 10 THEN IF CASTLE = 9 AND ROOM = 100 THEN LINE1$ = "This treasure belongs": LINE2$ = "to the first adventurer": LINE3$ = "who is brave enough to": LINE4$ = "find it.   -Rupert": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 10 THEN IF CASTLE = 9 AND ROOM = 401 THEN LINE1$ = "I grant this treasure": LINE2$ = "to he who needs it for": LINE3$ = "a noble purpose.": LINE4$ = "-Gomer, King of Tiwarel": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 10 THEN IF CASTLE = 9 AND ROOM = 104 THEN LINE1$ = "I predict that the one": LINE2$ = "who discovers this": LINE3$ = "treasure will someday": LINE4$ = "save the world. -artra": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 15 THEN IF CASTLE = 3 AND ROOM = 207 THEN LINE1$ = "Would you like to buy a": LINE2$ = "better weapon for $50?": LINE4$ = "[Y or N?]": LINE3$ = "": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 14 THEN IF CASTLE = 5 AND ROOM = 305 THEN LINE1$ = "I will give you a": LINE2$ = "spectacular weapon for": LINE3$ = "a modest sum of $99!": LINE4$ = "[Y or N?]": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 15 THEN IF CASTLE = 7 AND ROOM = 100 THEN LINE1$ = "Buy my magical": LINE2$ = "hammer for only $25!!": LINE3$ = "It can smash boulders!": LINE4$ = "Buy it? [Y or N]": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 14 THEN IF CASTLE = 8 AND ROOM = 302 THEN LINE1$ = "Buy my magical": LINE2$ = "recorder for only $40!!": LINE3$ = "It can do many things!": LINE4$ = "Buy it? [Y or N]": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 10 THEN IF CASTLE = 9 AND ROOM = 306 THEN LINE1$ = "One cannot enter the": LINE2$ = "Golden Palace unless he": LINE3$ = "has first conquered 5": LINE4$ = "castles of great evil.": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 10 THEN IF CASTLE = 5 AND ROOM = 202 THEN LINE1$ = "There is a powerful": LINE2$ = "weapon hidden inside": LINE3$ = "this castle. Find it": LINE4$ = "before you leave.": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 10 THEN IF CASTLE = 0 AND ROOM = 209 THEN LINE1$ = "  QUASA MOUNTAINS": LINE2$ = "  GOMER'S TOWER": LINE3$ = "  HERMIT'S CAVE": LINE4$ = "": GOSUB WINDOWS: MOVE = -1: RETURN


'town of marubia
IF POINT(DX, DY) = 10 THEN IF CASTLE = 0 AND ROOM = 405 THEN LINE1$ = "This is Marubia Inn.": LINE2$ = "The town of Marubia": LINE3$ = "lies eastward.": LINE4$ = "": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 10 THEN IF CASTLE = 0 AND ROOM = 406 THEN LINE1$ = "": LINE2$ = "       *WELCOME*": LINE3$ = "    TOWN OF MARUBIA": LINE4$ = "": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 15 THEN IF CASTLE = 9 AND ROOM = 408 THEN LINE1$ = "You should tell the": LINE2$ = "people in town about": LINE3$ = "your quest. They might": LINE4$ = "be able to help you.": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 12 THEN IF CASTLE = 0 AND ROOM = 406 THEN LINE1$ = "Rupert was a theif who": LINE2$ = "once lived here. He": LINE3$ = "kept his small fortune": LINE4$ = "in a cave near Tingal.": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 13 THEN IF CASTLE = 0 AND ROOM = 406 THEN LINE1$ = "You look like you could": LINE2$ = "use a drink. Try some": LINE3$ = "of my special whiskey.": LINE4$ = "": GOSUB WINDOWS: MOVE = -1: PLAY GULP$:  MAN = MAX: METER$ = "LIFE":    _
GOSUB LIFEMETER: RETURN
IF POINT(DX, DY) = 14 THEN IF CASTLE = 0 AND ROOM = 406 THEN LINE1$ = "The bell once belonged": LINE2$ = "to a powerful wizard": LINE3$ = "named Vartra. Since his": LINE4$ = "death, it has vanished.": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 15 THEN IF CASTLE = 0 AND ROOM = 406 THEN LINE1$ = "My brother owns the": LINE2$ = "inn. Are you enjoying": LINE3$ = "your stay there?": LINE4$ = "": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 18 THEN IF CASTLE = 0 AND ROOM = 406 THEN LINE1$ = "My little brother got": LINE2$ = "eaten by some goblins.": LINE3$ = "Please find the bell": LINE4$ = "before they eat me too!": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 12 THEN IF CASTLE = 8 AND ROOM = 406 THEN LINE1$ = "The first castle is": LINE2$ = "to the north-west. You": LINE3$ = "should begin your quest": LINE4$ = "there.": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 14 THEN IF CASTLE = 8 AND ROOM = 406 THEN LINE1$ = "A legend says that the": LINE2$ = "bell was hidden in a": LINE3$ = "far away palace made of": LINE4$ = "pure gold. It also says": LINE5$ = "that one must conquer": LINE6$ =  _
"5 castles of great evil": LINE7$ = "before he can enter": LINE8$ = "the Golden Palace.": GOSUB WINDOWS: MOVE = -1: RETURN


'village of tingal
IF POINT(DX, DY) = 10 THEN IF CASTLE = 0 AND ROOM = 100 THEN LINE1$ = "": LINE2$ = "       *WELCOME*": LINE3$ = "   VILLAGE OF TINGAL": LINE4$ = "": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 12 THEN IF CASTLE = 0 AND ROOM = 100 THEN LINE1$ = "I moved up here because": LINE2$ = "the taxes are very low.": LINE3$ = "In fact, nobody even": LINE4$ = "comes to collect them!": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 13 THEN IF CASTLE = 0 AND ROOM = 100 THEN LINE1$ = "With all the monsters,": LINE2$ = "it is too dangerous for": LINE3$ = "me to travel to Salum": LINE4$ = "to do my shopping.": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 14 THEN IF CASTLE = 0 AND ROOM = 100 THEN LINE1$ = "Vartra the wizard lived": LINE2$ = "near Salum. If you ever": LINE3$ = "go there, be sure to": LINE4$ = "ask about him.": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 15 THEN IF CASTLE = 0 AND ROOM = 100 THEN LINE1$ = "There is a shop south": LINE2$ = "of the mountains that": LINE3$ = "sells bottles of a": LINE4$ = "life-restoring elixer.": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 18 THEN IF CASTLE = 0 AND ROOM = 100 THEN LINE1$ = "Just imagine how much": LINE2$ = "candy I could buy if I": LINE3$ = "could find Rupert's": LINE4$ = "treasure!": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 15 THEN IF CASTLE = 8 AND ROOM = 100 THEN LINE1$ = "The bridge to the south": LINE2$ = "was built by King": LINE3$ = "Gomer. It is the only": LINE4$ = "way to cross the river.": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 13 THEN IF CASTLE = 8 AND ROOM = 100 THEN LINE1$ = "I'm so tired! But it": LINE2$ = "would be rude to take": LINE3$ = "a nap while I have": LINE4$ = "company over.": GOSUB WINDOWS: MOVE = -1: RETURN


'city of salum
IF POINT(DX, DY) = 10 THEN IF CASTLE = 0 AND ROOM = 709 THEN LINE1$ = "": LINE2$ = "       *WELCOME*": LINE3$ = "     CITY OF SALUM": LINE4$ = "": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 10 THEN IF CASTLE = 0 AND ROOM = 710 THEN LINE1$ = "": LINE2$ = "       *WELCOME*": LINE3$ = "     CITY OF SALUM": LINE4$ = "": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 12 THEN IF CASTLE = 0 AND ROOM = 709 THEN LINE1$ = "Salum has been the": LINE2$ = "largest and richest": LINE3$ = "city in Tiwarel since": LINE4$ = "the days of Vartra.": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 13 THEN IF CASTLE = 0 AND ROOM = 709 THEN LINE1$ = "I just love life in the": LINE2$ = "big city! I don't think": LINE3$ = "I could ever live in a": LINE4$ = "small town like Tingal.": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 14 THEN IF CASTLE = 0 AND ROOM = 709 THEN LINE1$ = "When I was a small boy,": LINE2$ = "Vartra used to do magic": LINE3$ = "tricks for all the kids": LINE4$ = "near this fountain.": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 12 THEN IF CASTLE = 0 AND ROOM = 809 THEN LINE1$ = "Vartra the wizard": LINE2$ = "posessed an enormous": LINE3$ = "treasure. Legend says": LINE4$ = "that he hid his wealth": LINE5$ = "near Gomer's Bridge,": LINE6$ =  _
"in a cave that has no": LINE7$ = "entrance. He must have": LINE8$ = "been quite a magician!": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 13 THEN IF CASTLE = 0 AND ROOM = 809 THEN LINE1$ = "Have you seen my little": LINE2$ = "Tommy? He ran away when": LINE3$ = "I told him to eat his": LINE4$ = "vegetables!": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 14 THEN IF CASTLE = 0 AND ROOM = 809 THEN LINE1$ = "Vartra's grave is on": LINE2$ = "the other side of the": LINE3$ = "lake, near the town of": LINE4$ = "Gorm.": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 15 THEN IF CASTLE = 0 AND ROOM = 809 THEN LINE1$ = "There are invisible": LINE2$ = "walls in some of the": LINE3$ = "castles. You can't see": LINE4$ = "them, but they're real!": LINE5$ = "There are also walls": LINE6$ =  _
"that look real, but are": LINE7$ = "only illusions. You can": LINE8$ = "run right through them.": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 18 THEN IF CASTLE = 0 AND ROOM = 809 THEN LINE1$ = "": LINE2$ = "I hate vegetables!": LINE3$ = "": LINE4$ = "": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 12 THEN IF CASTLE = 0 AND ROOM = 710 THEN LINE1$ = "Where are you from?": LINE2$ = COUNTRY$ + "?": LINE3$ = "I've never heard of it.": LINE4$ = "Is it near Marubia?": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 15 THEN IF CASTLE = 0 AND ROOM = 710 THEN LINE1$ = "These clumsy kids keep": LINE2$ = "getting themselves": LINE3$ = "pinched by the": LINE4$ = "lobsters!": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 18 THEN IF CASTLE = 0 AND ROOM = 710 THEN LINE1$ = "We are trying to catch": LINE2$ = "lobsters. Were going": LINE3$ = "to sell them at an": LINE4$ = "upcoming fair!": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 14 THEN IF CASTLE = 0 AND ROOM = 810 THEN LINE1$ = "That building has been": LINE2$ = "abandoned for years.": LINE3$ = "But I think there is": LINE4$ = "evil lurking inside...": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 18 THEN IF CASTLE = 0 AND ROOM = 810 THEN LINE1$ = "Ahhhhh...!": LINE2$ = "There are monsters": LINE3$ = "coming out of this": LINE4$ = "building!": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 15 THEN IF CASTLE = 8 AND ROOM = 709 THEN LINE1$ = "There is a haunted": LINE2$ = "castle in the middle of": LINE3$ = "the cemetary. Better": LINE4$ = "not go there!": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 13 THEN IF CASTLE = 8 AND ROOM = 709 THEN LINE1$ = "Now class, who can tell": LINE2$ = "me the sum of 9 and 14?": LINE3$ = "Anybody? ..well, we had": LINE4$ = "better work on that!": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 18 THEN IF CASTLE = 8 AND ROOM = 709 THEN LINE1$ = "": LINE2$ = "Isn't it 3:00 yet?": LINE3$ = "": LINE4$ = "": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 14 THEN IF CASTLE = 8 AND ROOM = 809 THEN LINE1$ = "Dave went for a walk": LINE2$ = "yesterday, and he": LINE3$ = "just hasn't been the": LINE4$ = "same since then.": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 12 THEN IF CASTLE = 8 AND ROOM = 809 THEN LINE1$ = "I went for a walk...": LINE2$ = "the grave...it was the": LINE3$ = "grave! ...and when I": LINE4$ = "came out, I saw it!": LINE5$ = "It was a palace of": LINE6$ =  _
"solid gold! I couldn't": LINE7$ = "believe my eyes! I": LINE8$ = "still can't believe it!": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 15 THEN IF CASTLE = 8 AND ROOM = 710 THEN LINE1$ = "When I get enough": LINE2$ = "money, I'm gonna open": LINE3$ = "up an elixer shop in": LINE4$ = "Salum.": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 18 THEN IF CASTLE = 8 AND ROOM = 710 THEN LINE1$ = "Mom grounded me because": LINE2$ = "I skipped school...": LINE3$ = "...again. Why do I": LINE4$ = "need school for anyway?": GOSUB WINDOWS: MOVE = -1: RETURN


'town of gorm
IF POINT(DX, DY) = 10 THEN IF CASTLE = 0 AND ROOM = 413 THEN LINE1$ = "": LINE2$ = "       *WELCOME*": LINE3$ = "     TOWN OF GORM": LINE4$ = "": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 12 THEN IF CASTLE = 0 AND ROOM = 413 THEN LINE1$ = "Gomer, a man from this": LINE2$ = "town, became Tiwarel's": LINE3$ = "greatest king. Before": LINE4$ = "his death, he put all": LINE5$ = "of his treasure in a": LINE6$ =  _
"tower. Look for the": LINE7$ = "tower in the forest": LINE8$ = "west of this town.": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 13 THEN IF CASTLE = 0 AND ROOM = 413 THEN LINE1$ = "I always lock my door": LINE2$ = "when I leave. I'd hate": LINE3$ = "to come home and find": LINE4$ = "a monster inside!": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 14 THEN IF CASTLE = 0 AND ROOM = 413 THEN LINE1$ = "The village of Wendel,": LINE2$ = "up in the mountains,": LINE3$ = "was totally destroyed": LINE4$ = "by the monsters.": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 18 THEN IF CASTLE = 0 AND ROOM = 413 THEN LINE1$ = "I used to play the": LINE2$ = "recorder. It was a very": LINE3$ = "popular instrument": LINE4$ = "in Gorm for many years.": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 15 THEN IF CASTLE = 8 AND ROOM = 413 THEN LINE1$ = "There is a castle to": LINE2$ = "the south-west, and": LINE3$ = "another up in the Quasa": LINE4$ = "Mountains.": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 13 THEN IF CASTLE = 8 AND ROOM = 413 THEN LINE1$ = "The city of Salum is": LINE2$ = "on the other side of": LINE3$ = "Lake Jyda. Go there": LINE4$ = "when you leave Gorm.": GOSUB WINDOWS: MOVE = -1: RETURN


'elixer shop
IF POINT(DX, DY) = 15 THEN IF CASTLE = 9 AND ROOM = 409 THEN LINE1$ = "Buy some of my world": LINE2$ = "famous cure-all elixer!": LINE3$ = "I'll give you a bottle": LINE4$ = "for only $20! [Y or N?]": GOSUB WINDOWS: MOVE = -1: RETURN
IF POINT(DX, DY) = 13 THEN IF CASTLE = 9 AND ROOM = 409 THEN LINE1$ = "": LINE2$ = "I'll give you a sample": LINE3$ = "of the elixer...": LINE4$ = "": GOSUB WINDOWS: MOVE = -1: PLAY GULP$:  MAN = MAX: METER$ = "LIFE": GOSUB LIFEMETER: RETURN
IF POINT(DX, DY) = 18 THEN IF CASTLE = 9 AND ROOM = 409 THEN LINE1$ = "I'm too young to sell": LINE2$ = "medicine. Dad says I": LINE3$ = "should get a lemonade": LINE4$ = "stand for now.": GOSUB WINDOWS: MOVE = -1: RETURN
RETURN

ADVANCEMENT:
FOR ADVANCE = 1 TO 5
PRESET (PX, PY), 0
GOSUB PLACEME
IF FACE$ = "UP" THEN Y = Y - .2
IF FACE$ = "LEFT" THEN X = X - .2
IF FACE$ = "RIGHT" THEN X = X + .2
IF FACE$ = "DOWN" THEN Y = Y + .2
GOSUB STEPME: GOSUB PLACEME
IF X > INT(X) + .5 THEN PX = INT(X) + 1 ELSE PX = INT(X)
IF Y > INT(Y) + .5 THEN PY = INT(Y) + 1 ELSE PY = INT(Y)
PSET (PX, PY), 1
TIME = TIMER + .1: WHILE TIMER < TIME: WEND
NEXT ADVANCE
RETURN

CLOSESHUTTERS:
FOR SHUT = 1 TO LEN(SHUTTER$) STEP 2
IF MID$(SHUTTER$, SHUT, 1) = " " THEN GOTO SKIPSHUTTER
PSET (ASC(MID$(SHUTTER$, SHUT, 1)), ASC(MID$(SHUTTER$, SHUT + 1, 1))), 3: PUT (ASC(MID$(SHUTTER$, SHUT, 1)) * 10, ASC(MID$(SHUTTER$, SHUT + 1, 1)) * 10), BARRIER, XOR: PLAY SHUTTERNOISE$
SKIPSHUTTER:
NEXT SHUT
IF CASTLE = 5 AND ROOM = 303 THEN PSET (29, 9), 3: PSET (29, 10), 3
RETURN

OPENSHUTTERS:
FOR SHUT = 1 TO LEN(SHUTTER$) STEP 2
IF MID$(SHUTTER$, SHUT, 1) = " " THEN GOTO SKIPSHUTTER2
PRESET (ASC(MID$(SHUTTER$, SHUT, 1)), ASC(MID$(SHUTTER$, SHUT + 1, 1))), 0: PUT (ASC(MID$(SHUTTER$, SHUT, 1)) * 10, ASC(MID$(SHUTTER$, SHUT + 1, 1)) * 10), BARRIER, XOR: PLAY SHUTTERNOISE$
SKIPSHUTTER2:
NEXT SHUT
IF CASTLE = 3 AND ROOM = 206 THEN PSET (23, 10), 6: PUT (230, 100), STAIRCASE, OR: PLAY SECRET$
IF CASTLE = 4 AND ROOM = 102 THEN PSET (11, 6), 6: PUT (110, 60), STAIRCASE, OR: PLAY SECRET$
IF CASTLE = 5 AND ROOM = 305 THEN IF BOOM < 4 THEN PSET (12, 5), 14: PSET (26, 5), 11: PUT (120, 50), GEEZER, OR: PUT (260, 50), CHEST, OR: PLAY SECRET$
RETURN

PAUSE: LINE1$ = "": LINE2$ = "       *PAUSED*": LINE3$ = "": LINE4$ = "": GOSUB WINDOWS: RETURN

WINDOWS:
DIM CLEARANCE(1 TO 3000)
GET (81, 74)-(278, 117), CLEARANCE
LINE (81, 74)-(278, 117), 4, B
LINE (82, 75)-(277, 116), 12, B
LINE (83, 76)-(276, 115), 13, B
LINE (84, 77)-(275, 114), 12, B
LINE (85, 78)-(274, 113), 4, B
LINE (86, 79)-(273, 112), 0, BF
IF LINE2$ = "       *PAUSED*" THEN PLAY PAUSE$: GOTO paused
IF sound$ <> "MUTE" THEN PLAY "MLT255L64O0C>D>E>F>G>A>BMN"
paused:
IF POINT(DX, DY) = 15 THEN IF CASTLE = 9 AND ROOM = 409 THEN IF MID$(ITEM$, 3, 1) = "X" THEN LINE1$ = "You've already got a": LINE2$ = "full bottle of elixer.": LINE3$ = "You don't need any more": LINE4$ = "right now."
REM    **, **        "b          m          e"      '23 chars max per line
COLOR 15
LOCATE 11, 12: PRINT LINE1$                         '4 lines max
LOCATE 12, 12: PRINT LINE2$
LOCATE 13, 12: PRINT LINE3$
LOCATE 14, 12: PRINT LINE4$
KEY(0) OFF
GOSUB READTIME
IF LINE5$ <> "" THEN LINE (86, 79)-(273, 112), 0, BF: LOCATE 11, 12: PRINT LINE5$: LOCATE 12, 12: PRINT LINE6$: LOCATE 13, 12: PRINT LINE7$: LOCATE 14, 12: PRINT LINE8$: GOSUB READTIME
LINE (81, 74)-(278, 117), 0, BF
PUT (81, 74), CLEARANCE, OR
IF LINE2$ = "       *PAUSED*" THEN PLAY PAUSE$: GOTO unpaused
IF sound$ <> "MUTE" THEN PLAY "MLT255L64O6B<A<G<F<E<D<CMN"
IF CASTLE = 3 AND ROOM = 207 THEN IF UCASE$(KEYSTROKE$) = "Y" AND MONEY >= 50 THEN MONEY = MONEY - 50: PSET (24, 8), 0: PUT (240, 80), BLOCK, XOR: PLAY SECRET$
IF CASTLE = 5 AND ROOM = 305 THEN IF UCASE$(KEYSTROKE$) = "Y" AND MONEY >= 99 THEN MONEY = MONEY - 99: PSET (24, 7), 0: PUT (240, 70), BLOCK, XOR: PLAY SECRET$
IF CASTLE = 7 AND ROOM = 100 THEN IF UCASE$(KEYSTROKE$) = "Y" AND MONEY >= 25 THEN MONEY = MONEY - 25: PSET (15, 7), 0: PSET (15, 8), 0: PUT (150, 70), LAVA, XOR: PUT (150, 80), LAVA, XOR: PUT (150, 70), LADDER, XOR: PUT (150, 80), LADDER, XOR: PLAY _
 SECRET$
IF CASTLE = 8 AND ROOM = 302 THEN IF UCASE$(KEYSTROKE$) = "Y" AND MONEY >= 40 THEN MONEY = MONEY - 40: PSET (17, 14), 0: PUT (170, 140), BLOCK, XOR: PLAY SECRET$
IF POINT(DX, DY) = 15 THEN IF CASTLE = 9 AND ROOM = 409 THEN IF UCASE$(KEYSTROKE$) = "Y" AND MONEY >= 20 THEN MONEY = MONEY - 20: PLAY SECRET$: MID$(ITEM$, 3, 1) = "X": METER$ = "ITEM": GOSUB ITEMMETER
unpaused:
LINE1$ = "": LINE2$ = "": LINE3$ = "": LINE4$ = "": LINE5$ = "": LINE6$ = "": LINE7$ = "": LINE8$ = ""
RETURN

READTIME: KEYSTROKE$ = INKEY$: IF KEYSTROKE$ = "" THEN GOTO READTIME
RETURN


GOMERSTOWER:
IF ROOM = 300 AND DX = 11 THEN EXIT$ = "CAV9#300.DAT 0 409 :6"
IF ROOM = 300 AND DX = 25 THEN EXIT$ = "CAV9#300.DAT 9 400 A/"
IF ROOM = 400 AND DX = 25 THEN EXIT$ = "CAV9#400.DAT 9 300 A/"
IF ROOM = 400 AND DX = 10 THEN EXIT$ = "CAV9#400.DAT 9 301 26"
IF ROOM = 301 AND DX = 10 THEN EXIT$ = "CAV9#301.DAT 9 400 26"
IF ROOM = 301 AND DX = 25 THEN EXIT$ = "CAV9#301.DAT 9 401 A/"
IF ROOM = 401 AND DX = 25 THEN EXIT$ = "CAV9#401.DAT 9 301 A/"
GOTO GOTEXITDATA

CHECKEXIT:
GOSUB PLACEME
GOSUB SCREEN4SCENE
FACE$ = "DOWN"
IF CASTLE = 9 THEN IF ROOM = 300 OR ROOM = 400 OR ROOM = 301 OR ROOM = 401 THEN GOTO GOMERSTOWER
IF CASTLE = 0 THEN IF ROOM = 100 OR ROOM = 406 OR ROOM = 413 OR ROOM = 709 OR ROOM = 710 OR ROOM = 809 THEN CASTLE = 8: CHAIN "GAME.BAS"
IF CASTLE = 8 THEN IF ROOM = 100 OR ROOM = 406 OR ROOM = 413 OR ROOM = 709 OR ROOM = 710 OR ROOM = 809 THEN CASTLE = 0: CHAIN "GAME.BAS"
OPEN "EXITS.DAT" FOR INPUT AS #1
DO
INPUT #1, EXIT$
IF LEFT$(EXIT$, 12) = FILESPEC$ THEN EXIT DO
LOOP
CLOSE #1
GOTEXITDATA:
CASTLE = ASC(MID$(EXIT$, 14, 1)) - 48
ROOM = VAL(MID$(EXIT$, 16, 3))
X = ASC(MID$(EXIT$, 20, 1)) - 40
Y = ASC(MID$(EXIT$, 21, 1)) - 40
CHAIN "GAME.BAS"

EXITDOS:
CLS : CHAIN "SAVE.BAS"

CHEATKEY:
IF CASTLE = 0 THEN RETURN
PLAY GETKEY$: KEYS = KEYS + 1: GOSUB ITEMMETER: RETURN

