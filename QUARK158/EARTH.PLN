COMMON X, Y, H, V, POWER!, N1!, N2!, N3!, MERCPROGRESS!, VENUPROGRESS!, EARTPROGRESS!, MARSPROGRESS!, JUPIPROGRESS!, SATUPROGRESS!, URANPROGRESS!, NEPTPROGRESS, PLUTPROGRESS!, BOMB1!
LET F = 180: LET G = 110
SCREEN 13: CLS
0 CLS
LOCATE 10, 1: COLOR 1: PRINT "INPUT '": COLOR 2: LOCATE 10, 8: PRINT "1": COLOR 1: LOCATE 10, 9: PRINT "' TO LAND ON EARTH."
LOCATE 12, 1: COLOR 1: PRINT "INPUT '": COLOR 2: LOCATE 12, 8: PRINT "2": COLOR 1: LOCATE 12, 9: PRINT "' TO REFILL POWER AT PORT."
LOCATE 14, 1: COLOR 1: PRINT "INPUT '": COLOR 2: LOCATE 14, 8: PRINT "3": COLOR 1: LOCATE 14, 9: PRINT "' TO LAUNCH INTO SPACE."
1 LOCATE 16, 1: COLOR 2: INPUT "", CHOICE!
IF CHOICE! = 1 THEN GOTO LAND
IF CHOICE! = 2 THEN GOTO REFILL
IF CHOICE! = 3 THEN CHAIN "SOLAR.SYS"
GOTO 1

REFILL:
CLS : LOCATE 10, 1: COLOR 10: PRINT "POWER UNITS:"
COLOR 7
FOR P = 100 TO 1200 STEP 2
LOCATE 10, 13: PRINT POWER!
IF POWER! = 500 THEN EXIT FOR
LET POWER! = POWER! + 1
SOUND P, .2
NEXT P
LOCATE 12, 1: COLOR 10: PRINT "POWER HAS BEEN REFILLED"
PLAY "T200L50O2CDEDO1CDEDC"
SLEEP 3
GOTO 0

LAND:
SCREEN 13: CLS : DIM ICON%(1 TO 30): DRAW "BM50,50 C255 R2D1L2R1D2L2R4L2D2G2E2F2H2": GET (49, 50)-(54, 57), ICON%
CLS : DIM TREE%(1 TO 50): DRAW "BM50,50 C6R1U1L1U1R1BU1C120R1L3U1R3U1L3U1R3H1L1U1R1": GET (49, 42)-(52, 50), TREE%
CLS : DIM HOUSE%(1 TO 50): DRAW "BM50,50 C6D7U7R9D7L8R1U4R5D4BH1P255,6BR2P6,6": GET (50, 50)-(59, 57), HOUSE%
PAINT (160, 100), 2
FOR B = 1 TO 90
5 RANDOMIZE 1
LET R = INT(RND * 15) + 5
LET U = INT(RND * 300) + 11
LET K = INT(RND * 180) + 6
IF POINT(U, K) = 2 THEN CIRCLE (U, K), R, 1: PAINT (U, K), 1, 1
NEXT B
FOR T = 1 TO 100
RANDOMIZE 1
LET U = INT(RND * 300) + 11
LET K = INT(RND * 180) + 9
IF POINT(U, K) = 2 AND POINT(U, K + 1) = 2 AND POINT(U + 1, K) = 2 AND POINT(U + 1, K + 1) = 2 THEN PUT (U - 1, K - 8), TREE%, OR
NEXT T
FOR T = 1 TO 100
RANDOMIZE 2
LET U = INT(RND * 300) + 11
LET K = INT(RND * 180) + 9
IF POINT(U, K) = 2 AND POINT(U, K + 1) = 2 AND POINT(U + 1, K) = 2 AND POINT(U + 1, K + 1) = 2 THEN PUT (U - 1, K - 8), TREE%, OR
NEXT T
FOR T = 1 TO 100
RANDOMIZE 3
LET U = INT(RND * 300) + 11
LET K = INT(RND * 180) + 9
IF POINT(U, K) = 2 AND POINT(U, K + 1) = 2 AND POINT(U + 1, K) = 2 AND POINT(U + 1, K + 1) = 2 THEN PUT (U - 1, K - 8), TREE%, OR
NEXT T
PUT (290, 183), HOUSE%, OR
PUT (270, 178), HOUSE%, OR
PUT (300, 163), HOUSE%, OR
DRAW "BM10,20C64U20R5D10R2E1R5F1R2D10L15R8U6R4D6L3BU1P64,64BL5P131,64"
IF POINT(F, G) = 1 THEN PAINT (F, G), 2, 2
PUT (F - 2, G - 4), ICON%, XOR
PRESET (200, 100): DRAW "C7D1F1D2BL2U2BF3G2H2D8BR4U7BF3R1D5L2U4D2G2R8D1G3L3U3F1E1BD6F1D2H1L3H1G1L1R1E2BR2H1L1U2G2L1BU6R1F1D2"
PRESET (200, 100): DRAW "C7D1G1D2BR2U2BG3F2E2D8BL4U7BG3L1D5R2U4D2F2L8D1F3R3U3G1H1BD6G1D2E1R3E1F1R1L1H2BL2E1R1U2F2R1BU6L1G1D2"
PAINT (200, 102), 8, 7: PAINT (200, 108), 8, 7: PAINT (200, 115), 8, 7: PAINT (200, 121), 8, 7: PAINT (204, 121), 8, 7: PAINT (196, 121), 8, 7: PAINT (195, 117), 8, 7: PAINT (197, 117), 8, 7: PAINT (203, 117), 8, 7: PAINT (205, 117), 8, 7: PAINT (205, 115), 12, 7: PAINT (195, 115), 12, 7: PAINT (195, 113), 8, 7: PAINT (205, 113), 8, 7
ON KEY(11) GOSUB 100
ON KEY(12) GOSUB 200
ON KEY(13) GOSUB 300
ON KEY(14) GOSUB 400
KEY(0) ON

10 DO
IF F = 200 THEN IF G = 110 OR G = 115 THEN CHAIN "SOLAR.SYS"
IF F = 20 AND G = 20 THEN GOTO 1000
IF F = 275 AND G = 185 THEN GOTO 2000
IF F = 295 AND G = 190 THEN GOTO 3000
IF F = 305 AND G = 170 THEN GOTO 4000
LOOP UNTIL INKEY$ = ""
SYSTEM

100 KEY(0) STOP
IF G - 5 <= 0 THEN KEY(0) ON: RETURN
IF POINT(F, G - 6) = 1 THEN KEY(0) ON: RETURN
PUT (F - 2, G - 4), ICON%, XOR
LET G = G - 5: PUT (F - 2, G - 4), ICON%, XOR
KEY(0) ON: RETURN

200 KEY(0) STOP
IF POINT(F - 3, G + 3) = 1 THEN KEY(0) ON: RETURN
IF F - 5 <= 0 THEN KEY(0) ON: RETURN
PUT (F - 2, G - 4), ICON%, XOR
LET F = F - 5: PUT (F - 2, G - 4), ICON%, XOR
KEY(0) ON: RETURN

300 KEY(0) STOP
IF POINT(F + 3, G + 3) = 1 THEN KEY(0) ON: RETURN
IF F + 5 >= 320 THEN KEY(0) ON: RETURN
PUT (F - 2, G - 4), ICON%, XOR
LET F = F + 5: PUT (F - 2, G - 4), ICON%, XOR
KEY(0) ON: RETURN

400 KEY(0) STOP
IF POINT(F, G + 5) = 1 THEN KEY(0) ON: RETURN
IF POINT(F, G + 6) = 1 THEN KEY(0) ON: RETURN
IF POINT(F, G + 7) = 1 THEN KEY(0) ON: RETURN
IF G + 5 >= 200 THEN KEY(0) ON: RETURN
PUT (F - 2, G - 4), ICON%, XOR
LET G = G + 5: PUT (F - 2, G - 4), ICON%, XOR
KEY(0) ON: RETURN

1000 SCREEN 8: CLS : COLOR 1: PRINT "(RESIDENCE OF PRESIDENT GEORGE WASHINGTON II, EARTH)"
IF MARSPROGRESS! > 1 THEN GOTO 1010
PRINT : COLOR 2: PRINT "WASHINGTON: What are you waiting for?"
PRINT "Destroy the wretched QUARK factory before the QUARK clones destory Earth": SLEEP 40: LET G = G + 5: GOTO LAND

1010
COLOR 2: PRINT : PRINT "WASHINGTON: Mr. Maelstrom, you have my presidential permission to search"
PRINT "my planet for the traitor, but do not disturb me again. I am busy."
COLOR 15: PRINT : PRINT "MAELSTROM: Thank-you very much. I shall make full use of your permission.": SLEEP 60: LET G = G + 5: GOTO LAND

2000 SCREEN 8: CLS : COLOR 2: PRINT "(SMALL COTTAGE, EARTH)"
IF EARTPROGRESS! > 0 THEN GOTO 2030
COLOR 9: PRINT : PRINT "WOMAN: -<SHRIEK>- ": SLEEP 2
COLOR 2: PRINT : PRINT "MAN: Who is there?"
COLOR 15: PRINT : INPUT "MAELSTROM: ", TALK$
IF MARSPROGRESS! > 1 THEN IF LEFT$(TALK$, 4) = "MIKE" OR LEFT$(TALK$, 4) = "mike" OR RIGHT$(TALK$, 9) = "MAELSTROM" OR RIGHT$(TALK$, 9) = "maelstrom" THEN GOTO 2010
COLOR 2: PRINT : PRINT "MAN: Get out of here, and leave us alone!": SLEEP 10: LET G = G + 5: GOTO LAND
2010 SCREEN 8: CLS : COLOR 2: PRINT "(SMALL COTTAGE, EARTH)"
COLOR 2: PRINT : PRINT "MAN: Oh, hello Mike! Do come in.": SLEEP 2
PRINT "What brings you here?"
COLOR 15: PRINT : PRINT "MAELSTROM: I am looking for the traitor who gave the QUARK-79 project"
PRINT "to Igor Nemisvitz."
COLOR 2: PRINT : PRINT "MAN: What is his name?"
COLOR 15: PRINT : INPUT "MAELSTROM: ", TALK$
IF LEFT$(TALK$, 12) = "I DON'T KNOW" OR LEFT$(TALK$, 11) = "I DONT KNOW" THEN GOTO 2020
IF RIGHT$(TALK$, 12) = "I DON'T KNOW" OR LEFT$(TALK$, 11) = "I DONT KNOW" THEN GOTO 2020
IF TALK$ = "MATT NOUGAT" OR TALK$ = "matt nougat" OR TALK$ = "NOUGAT" OR TALK$ = "nougat" THEN LET EARTPROGRESS! = EARTPROGRESS! + 1: GOTO 2030
COLOR 2: PRINT : PRINT "MAN: I don't recall a "; TALK$; ". Sorry, but I can't help you.": SLEEP 20: LET G = G + 5: GOTO LAND
2020 COLOR 2: PRINT : PRINT "MAN: If you don't know who he is, then I cannot help you.": SLEEP 20: LET G = G + 5: GOTO LAND
2030 COLOR 2: PRINT : PRINT "MAN: I never would have suspected Matt..."
PRINT "But if you must know, Matt Nougat resides in a cottage northeast of here.": SLEEP 60: LET G = G + 5: GOTO LAND

3000 SCREEN 8: CLS : COLOR 2: PRINT "(SMALL COTTAGE, EARTH)"
PRINT : COLOR 15: PRINT "LOTS OF EQUIPMENT IS PILED IN THE CORNERS. BESIDES THAT, THE COTTAGE IS EMPTY.": SLEEP 20: LET G = G + 5: GOTO LAND

4000 IF EARTPROGRESS! = 2 THEN GOTO 5000
IF EARTPROGRESS! = 1 THEN GOTO 4500
SCREEN 8: CLS : COLOR 2: PRINT "(SMALL COTTAGE, EARTH)"
PRINT : COLOR 2: PRINT "STRANGER: *@%#@!": SLEEP 10: LET G = G + 5: GOTO LAND
4500 SCREEN 8: CLS : COLOR 2: PRINT "(MATT NOUGAT'S HIDEOUT, EARTH)"
PRINT : COLOR 2: PRINT "NOUGAT: You shall never catch me, Maelstrom!": SLEEP 5
COLOR 15: PRINT : PRINT "MAELSTROM: The GFP shall prevail, and you shall be executed!": SLEEP 10: LET G = G + 5
PRINT : COLOR 15: PRINT "NOUGAT RACES OUT THE DOOR, AND JUMPS INTO A CONCEALED SPACESHIP.": SLEEP 10
PRINT : COLOR 15: PRINT "YOU ENTER YOUR SPACESHIP, BUT YOU ARE TOO LATE...HE HAS GOTTEN AWAY!": SLEEP 10: LET EARTPROGRESS! = EARTPROGRESS! + 1: CHAIN "SOLAR.SYS"
5000 SCREEN 8: CLS : COLOR 2: PRINT "(SMALL COTTAGE, EARTH)"
COLOR 15: PRINT : PRINT "THE COTTAGE IS EMPTY...": LET G = G + 5: SLEEP 20: GOTO LAND

