COMMON PROGRESS$, SPEED, BOOMERANG, MAX, MAN, ROOM, CASTLE, X, Y, PX, PY, FACE$, STEPS, MONEY, KEYS, ITEM$, SOUND$, NAME$, COUNTRY$, SAVEFILE$
SCREEN 13
DIM CURSOR(1 TO 100)
DIM title(1 TO 16383)
DRAW "BM0,0C32BR4DBL4C33NR5BDC34NR6BDC35NR5BDBR4C36D0": GET (0, 0)-(7, 5), CURSOR
CLS
DEF SEG = VARSEG(title(1))
BLOAD "mtitle.pic", VARPTR(title(1))
DEF SEG
PUT (23, 10), title, OR
C = 0: CDIR = 4

PAINT (1, 1), 17, 17
LOCATE 17, 10: COLOR 7: PRINT "PRESS ENTER TO START!"
KEY 15, CHR$(0) + CHR$(28)
KEY 16, CHR$(32) + CHR$(28)
KEY 17, CHR$(64) + CHR$(28)
KEY 18, CHR$(96) + CHR$(28)
ON KEY(15) GOSUB DONEMUSIC
ON KEY(16) GOSUB DONEMUSIC
ON KEY(17) GOSUB DONEMUSIC
ON KEY(18) GOSUB DONEMUSIC
KEY(0) ON

DO
READ Q$: IF Q$ = "FIN" THEN EXIT DO
PLAY "ML>L64": PLAY Q$: PLAY "<L16": PLAY Q$: PLAY "<L64": PLAY Q$: PLAY ">L16"
GOSUB EFFECT
LOOP UNTIL INKEY$ = ""
IF Q$ <> "FIN" THEN CLS : SYSTEM
DONEMUSIC:
PALETTE 17, 25
KEY(0) OFF
LOCATE 17, 10: PRINT "                    "
MODE$ = "REGULAR"
SELECTION:
OPEN "FILE1" FOR INPUT AS #1
OPEN "FILE2" FOR INPUT AS #2
OPEN "FILE3" FOR INPUT AS #3


INPUT #1, A$: IF LEFT$(A$, 1) = "" THEN A$ = "<EMPTY>"
INPUT #2, B$: IF LEFT$(B$, 1) = "" THEN B$ = "<EMPTY>"
INPUT #3, C$: IF LEFT$(C$, 1) = "" THEN C$ = "<EMPTY>"
CLOSE #1
CLOSE #2
CLOSE #3
SELECTOR = 1
LOCATE 14, 12: COLOR 56: PRINT "MAKE A SELECTION    "; : IF MODE$ = "ERASER" THEN LOCATE 14, 12: PRINT "SELECT FILE TO ERASE"
LOCATE 16, 12: COLOR 7: PRINT "1...."; : COLOR 34: PRINT A$; "         "
LOCATE 17, 12: COLOR 7: PRINT "2...."; : COLOR 34: PRINT B$; "         "
LOCATE 18, 12: COLOR 7: PRINT "3...."; : COLOR 34: PRINT C$; "         "
LOCATE 20, 12: COLOR 7: PRINT "4...."; : COLOR 34: PRINT "ERASE MODE      ": IF MODE$ = "ERASER" THEN LOCATE 20, 17: PRINT "RETURN TO MAIN"
DO: SELECTION$ = INKEY$: LOOP UNTIL SELECTION$ <> ""
IF SELECTION$ = "1" THEN GOTO 1
IF SELECTION$ = "2" THEN GOTO 2
IF SELECTION$ = "3" THEN GOTO 3
IF SELECTION$ = "4" THEN GOTO ERASETOGGLE
IF SELECTION$ = "" THEN CLS : SYSTEM
GOTO SELECTION

ERASETOGGLE:
IF MODE$ = "REGULAR" THEN MODE$ = "ERASER" ELSE MODE$ = "REGULAR"
GOTO SELECTION


EFFECT:
C = C + CDIR
IF C >= 62 THEN C = 61: CDIR = -(CDIR)
IF C <= -1 THEN C = 0: CDIR = -(CDIR)
PALETTE 17, C
RETURN


1
IF MODE$ = "REGULAR" THEN GOTO LOAD1
OPEN "FILE1" FOR OUTPUT AS #1
PRINT #1, ""
PLAY "t255l64o1mlcgdafe>cgdafe<cgdafet255l64o3msccccc<bbbb<aaa<gg<ff<e"
CLOSE #1: GOTO SELECTION
2
IF MODE$ = "REGULAR" THEN GOTO LOAD2
OPEN "FILE2" FOR OUTPUT AS #1
PRINT #1, ""
PLAY "t255l64o1mlcgdafe>cgdafe<cgdafet255l64o3msccccc<bbbb<aaa<gg<ff<e"
CLOSE #1: GOTO SELECTION
3
IF MODE$ = "REGULAR" THEN GOTO LOAD3
OPEN "FILE3" FOR OUTPUT AS #1
PRINT #1, ""
PLAY "t255l64o1mlcgdafe>cgdafe<cgdafet255l64o3msccccc<bbbb<aaa<gg<ff<e"
CLOSE #1: GOTO SELECTION

LOAD1:
SAVEFILE$ = "FILE1"
OPEN "FILE1" FOR INPUT AS #1
ENTRY = 1: GOTO LOADEMUP
LOAD2:
SAVEFILE$ = "FILE2"
OPEN "FILE2" FOR INPUT AS #1
ENTRY = 2: GOTO LOADEMUP
LOAD3:
SAVEFILE$ = "FILE3"
OPEN "FILE3" FOR INPUT AS #1
ENTRY = 3: GOTO LOADEMUP

LOADEMUP:
PLAY "T255L32MlO5gfc<gfc<gfc<gfc<gfc"
INPUT #1, NAME$
IF NAME$ = "" THEN GOTO NEWBY
INPUT #1, COUNTRY$
INPUT #1, BOOMERANG
INPUT #1, MAX
INPUT #1, MONEY
INPUT #1, KEYS
INPUT #1, ITEM$
INPUT #1, PROGRESS$
CLOSE #1
STEPS = 1: FACE$ = "DOWN": X = 16: Y = 11: ROOM = 405: CASTLE = 0: MAN = MAX
CHAIN "GAME.BAS"

NEWBY:
CLOSE #1
LINE (53, 100)-(257, 159), 0, BF
LOCATE 15, 11: COLOR 7: PRINT "WHAT IS YOUR NAME?"
LOCATE 16, 11: COLOR 34: INPUT "", NAME$
LOCATE 18, 11: COLOR 7: PRINT "FROM WHAT LAND?"
LOCATE 19, 11: COLOR 34: INPUT "", COUNTRY$
BOOMERANG = 1
MAX = 10
MONEY = 0
KEYS = 0
ITEM$ = "OOO"
PROGRESS$ = "OOOOOOOOOOOOOOOOOOOO"
STEPS = 1: FACE$ = "DOWN": X = 16: Y = 11: ROOM = 405: CASTLE = 0: MAN = MAX
IF ENTRY = 1 THEN SAVEFILE$ = "FILE1": OPEN "FILE1" FOR OUTPUT AS #1
IF ENTRY = 2 THEN SAVEFILE$ = "FILE2": OPEN "FILE2" FOR OUTPUT AS #1
IF ENTRY = 3 THEN SAVEFILE$ = "FILE3": OPEN "FILE3" FOR OUTPUT AS #1
PRINT #1, NAME$
PRINT #1, COUNTRY$
PRINT #1, BOOMERANG
PRINT #1, MAX
PRINT #1, MONEY
PRINT #1, KEYS
PRINT #1, ITEM$
PRINT #1, PROGRESS$
CLOSE #1
CHAIN "START.BAS"

DATA t200,O1F#,F#,G,G,G,G,A,A,B,B,B,B,P16,B,B,B,B,B,B,B,B,A,A,G,G,F,F,G,G,A,A,D,D,P16,D,D,A,A,P16,A,A,G,G,P16,G,G,E,E,P16,E,E,F,F,P16,F,F,O2C,C,P16,C,C,O1B,B,P16,B,B,A,A,P16,A,A,G,G,P16,G,G,O2E,E,P16,E,E,D,D,P16,D,D,C,C,P16,C,C,O1B,B,B,B,P16,B,B,B,B,B,B,B,B,A,A,G,G,F,F,G,G,A,A,E,E,P16,E,E,A,A,P16,A,A,G,G,P16,G,G,E,E,P16,E,E,D,D,O0B,B,O1D,D,G,G,D,D,G,G,B,B,G,G,A,A,B,B,O2C,C,C#,C#,D,D,P16,F,F,D,D,C,C,O0A,A,G,G,O1G,G,A,A,C,C,C,C,C,C,C,C,P4, FIN



